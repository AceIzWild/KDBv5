<div class="mxgraph" style="max-width:100%;border:1px solid transparent;" data-mxgraph="{&quot;highlight&quot;:&quot;#0000ff&quot;,&quot;nav&quot;:true,&quot;resize&quot;:true,&quot;toolbar&quot;:&quot;zoom layers tags lightbox&quot;,&quot;edit&quot;:&quot;_blank&quot;,&quot;xml&quot;:&quot;&lt;mxfile&gt;&lt;diagram id=\&quot;8ZDkOZxjIo5987FU1LKY\&quot; name=\&quot;Page-1\&quot;&gt;&lt;mxGraphModel dx=\&quot;3187\&quot; dy=\&quot;1512\&quot; grid=\&quot;1\&quot; gridSize=\&quot;10\&quot; guides=\&quot;1\&quot; tooltips=\&quot;1\&quot; connect=\&quot;1\&quot; arrows=\&quot;1\&quot; fold=\&quot;1\&quot; page=\&quot;1\&quot; pageScale=\&quot;1\&quot; pageWidth=\&quot;2500\&quot; pageHeight=\&quot;6000\&quot; math=\&quot;0\&quot; shadow=\&quot;0\&quot;&gt;&lt;root&gt;&lt;mxCell id=\&quot;0\&quot;/&gt;&lt;mxCell id=\&quot;1\&quot; parent=\&quot;0\&quot;/&gt;&lt;mxCell id=\&quot;67\&quot; style=\&quot;edgeStyle=none;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;fontSize=14;fontColor=#000000;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;2\&quot; target=\&quot;5\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;68\&quot; style=\&quot;edgeStyle=none;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=14;fontColor=#000000;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;2\&quot; target=\&quot;8\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;2\&quot; value=\&quot;&amp;lt;font style=&amp;quot;font-size: 25px;&amp;quot;&amp;gt;AD Attack Map&amp;lt;/font&amp;gt;\&quot; style=\&quot;rounded=0;whiteSpace=wrap;html=1;fillColor=#006100;strokeColor=#005700;fontColor=#ffffff;shadow=1;glass=0;sketch=1;curveFitting=1;jiggle=2;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;1126\&quot; y=\&quot;30\&quot; width=\&quot;259\&quot; height=\&quot;120\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;10\&quot; style=\&quot;edgeStyle=none;html=1;exitX=1;exitY=1;exitDx=0;exitDy=0;fontSize=20;entryX=0.25;entryY=0;entryDx=0;entryDy=0;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;5\&quot; target=\&quot;13\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;&lt;mxPoint x=\&quot;1236\&quot; y=\&quot;491\&quot; as=\&quot;targetPoint\&quot;/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;5\&quot; value=\&quot;&amp;lt;font style=&amp;quot;font-size: 20px;&amp;quot;&amp;gt;&amp;lt;b&amp;gt;External&amp;lt;br&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;br&amp;gt;Expploit vulnerabiliy via public-facing services&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;Enumerate and find Active Directory domain&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;Exploit vulnerability on domain-joined host\&quot; style=\&quot;whiteSpace=wrap;html=1;aspect=fixed;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;791\&quot; y=\&quot;206\&quot; width=\&quot;274\&quot; height=\&quot;274\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;11\&quot; style=\&quot;edgeStyle=none;html=1;fontSize=20;exitX=0;exitY=1;exitDx=0;exitDy=0;entryX=0.75;entryY=0;entryDx=0;entryDy=0;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;8\&quot; target=\&quot;13\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;&lt;mxPoint x=\&quot;1276\&quot; y=\&quot;491\&quot; as=\&quot;targetPoint\&quot;/&gt;&lt;mxPoint x=\&quot;1466\&quot; y=\&quot;401\&quot; as=\&quot;sourcePoint\&quot;/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;8\&quot; value=\&quot;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;font-size: 20px;&amp;quot;&amp;gt;&amp;lt;b&amp;gt;Internal&amp;amp;nbsp;&amp;lt;br&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/span&amp;gt;LLMNR | NBNS Poisoning&amp;amp;nbsp;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;SMB Relay&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;IPv6 DNS Spoofing&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;ARP Poisoning&amp;lt;/font&amp;gt;&amp;lt;span style=&amp;quot;font-size: 20px;&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/span&amp;gt;\&quot; style=\&quot;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#eeeeee;strokeColor=#36393d;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;1430.94\&quot; y=\&quot;220\&quot; width=\&quot;260\&quot; height=\&quot;260\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;16\&quot; value=\&quot;\&quot; style=\&quot;edgeStyle=none;html=1;fontSize=12;fontColor=#000000;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;13\&quot; target=\&quot;15\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;13\&quot; value=\&quot;&amp;lt;font style=&amp;quot;font-size: 12px;&amp;quot;&amp;gt;&amp;lt;b&amp;gt;Foothold on &amp;lt;br&amp;gt;Domain-joined Host&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;\&quot; style=\&quot;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#fa6800;fontColor=#000000;strokeColor=#C73500;rounded=1;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;1187.5\&quot; y=\&quot;480\&quot; width=\&quot;115\&quot; height=\&quot;115\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;21\&quot; value=\&quot;\&quot; style=\&quot;edgeStyle=none;html=1;fontSize=12;fontColor=#000000;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;15\&quot; target=\&quot;20\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;24\&quot; value=\&quot;\&quot; style=\&quot;edgeStyle=none;html=1;fontSize=12;fontColor=#000000;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;15\&quot; target=\&quot;23\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;15\&quot; value=\&quot;&amp;lt;b&amp;gt;Current user privilege level?&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;Need to elevate privilege?&amp;lt;br&amp;gt;&amp;lt;/b&amp;gt;Some enumeration steps require elevated privileges on the compromised host&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;b&amp;gt;Any endpoint defenses (AV/EDR)?&amp;lt;/b&amp;gt;\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fontSize=12;fontColor=#333333;fillColor=#f5f5f5;strokeColor=#666666;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;1065\&quot; y=\&quot;616\&quot; width=\&quot;360\&quot; height=\&quot;120\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;20\&quot; value=\&quot;&amp;lt;div&amp;gt;Windows PrivEsc QRG&#39;s&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;span style=&amp;quot;background-color: initial;&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;span style=&amp;quot;background-color: initial;&amp;quot;&amp;gt;HackTricks&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;PayloadsAllTheThings&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;My Checklist from TryHackMe&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/div&amp;gt;\&quot; style=\&quot;whiteSpace=wrap;html=1;aspect=fixed;fontSize=12;fontColor=#ffffff;fillColor=#0050ef;strokeColor=#001DBC;rounded=1;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;1505\&quot; y=\&quot;601\&quot; width=\&quot;150\&quot; height=\&quot;150\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;26\&quot; value=\&quot;\&quot; style=\&quot;edgeStyle=none;html=1;fontSize=12;fontColor=#000000;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;23\&quot; target=\&quot;25\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;28\&quot; value=\&quot;\&quot; style=\&quot;edgeStyle=none;html=1;fontSize=12;fontColor=#000000;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;23\&quot; target=\&quot;27\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;23\&quot; value=\&quot;&amp;lt;b&amp;gt;Enumerate all other domain workstations, servers, and controllers&amp;lt;br&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;b&amp;gt;Tool Examples:&amp;lt;br&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;ldapdomaindump, ldapserach, enum4linux, crackmapexec, adidnsdump, PowerView\&quot; style=\&quot;rounded=0;whiteSpace=wrap;html=1;fontSize=12;fontColor=#000000;fillColor=#e3c800;strokeColor=#B09500;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;1010\&quot; y=\&quot;766\&quot; width=\&quot;470\&quot; height=\&quot;100\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;25\&quot; value=\&quot;&amp;lt;b&amp;gt;Microsoft Office DCOM Lateral Pivot&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;If Microsoft Office&amp;amp;nbsp;installed on the compromised host, you have admin on the compromised host, and the lateral target has MS Office installed.&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;Best used on workstations where MS Office more likely to be installed.\&quot; style=\&quot;whiteSpace=wrap;html=1;aspect=fixed;fontSize=12;fontColor=#000000;fillColor=#fa6800;strokeColor=#C73500;rounded=1;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;705\&quot; y=\&quot;686\&quot; width=\&quot;280\&quot; height=\&quot;280\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;31\&quot; value=\&quot;\&quot; style=\&quot;edgeStyle=none;html=1;fontSize=12;fontColor=#000000;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;27\&quot; target=\&quot;30\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;33\&quot; value=\&quot;\&quot; style=\&quot;edgeStyle=none;html=1;fontSize=12;fontColor=#000000;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;27\&quot; target=\&quot;32\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;27\&quot; value=\&quot;&amp;lt;b&amp;gt;Enumerate domain policies&amp;lt;br&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;b&amp;gt;Tool Examples:&amp;lt;br&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;crackmapexec, PowerView, ldapdomaindump, enum4linux&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;b&amp;gt;Add workstations to domain?&amp;lt;br&amp;gt;&amp;lt;/b&amp;gt;ms-DS-MachineAccountQuota?&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;b&amp;gt;Account lockouts?&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;- Lockout threshold&amp;lt;br&amp;gt;- Lockout observation window&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;b&amp;gt;Password complexity?&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;Determine authentication scheme&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;b&amp;gt;Kerberos? (NTLM Fallback)?&amp;lt;br&amp;gt;NTLM? &amp;lt;/b&amp;gt;(pass the hash)\&quot; style=\&quot;whiteSpace=wrap;html=1;aspect=fixed;fontSize=12;fontColor=#000000;fillColor=#e3c800;strokeColor=#B09500;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;1085\&quot; y=\&quot;896\&quot; width=\&quot;320\&quot; height=\&quot;320\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;30\&quot; value=\&quot;&amp;lt;b&amp;gt;Can we add computers to the domain?&amp;lt;br&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;b&amp;gt;Computer Accounts &amp;lt;/b&amp;gt;can inherit permissions from groups in the same way users can.&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;b&amp;gt;Can&amp;amp;nbsp;use scripts to join computers to the domain with known user&amp;amp;nbsp;credentials. &amp;lt;br&amp;gt;&amp;lt;br&amp;gt;The computer account gets a username and password like a&amp;amp;nbsp;user.&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;b&amp;gt;Tool example: &amp;lt;/b&amp;gt;impacket-addcomputer&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;Username ends with a &amp;lt;b&amp;gt;$&amp;amp;nbsp;&amp;lt;/b&amp;gt;Plus what ever password you used to join&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;Can then use tools like &amp;lt;b&amp;gt;crackmapexec&amp;lt;/b&amp;gt;&amp;amp;nbsp;with the computer account credentials to determine misconfigured inherited privileges\&quot; style=\&quot;whiteSpace=wrap;html=1;aspect=fixed;fontSize=12;fontColor=#000000;fillColor=#fa6800;strokeColor=#C73500;rounded=1;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;1455\&quot; y=\&quot;901\&quot; width=\&quot;310\&quot; height=\&quot;310\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;36\&quot; style=\&quot;edgeStyle=none;html=1;entryX=0.976;entryY=0.997;entryDx=0;entryDy=0;entryPerimeter=0;fontSize=12;fontColor=#000000;exitX=0;exitY=0.5;exitDx=0;exitDy=0;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;32\&quot; target=\&quot;35\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;38\&quot; style=\&quot;edgeStyle=none;html=1;entryX=1.003;entryY=0.054;entryDx=0;entryDy=0;entryPerimeter=0;fontSize=12;fontColor=#000000;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; target=\&quot;37\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;&lt;mxPoint x=\&quot;945\&quot; y=\&quot;1331\&quot; as=\&quot;sourcePoint\&quot;/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;43\&quot; value=\&quot;\&quot; style=\&quot;edgeStyle=none;html=1;fontSize=12;fontColor=#000000;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;32\&quot; target=\&quot;42\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;32\&quot; value=\&quot;&amp;lt;b&amp;gt;Enumerate domain users and groups&amp;lt;br&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;Define high-value groups and their members&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;Watch out for nested groups&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;b&amp;gt;Tool Examples&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;net.exe, powershell, Bloodhound, GetADUsers.py, ldapdomaindump, ldapsearch, crackmapexec, enum4linux\&quot; style=\&quot;rounded=0;whiteSpace=wrap;html=1;fontSize=12;fontColor=#000000;fillColor=#e3c800;strokeColor=#B09500;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;945\&quot; y=\&quot;1256\&quot; width=\&quot;600\&quot; height=\&quot;150\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;35\&quot; value=\&quot;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;b&amp;gt;Enumerate DCSync Privileges&amp;lt;br&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;b&amp;gt;DS-Replication-Get-Changes&amp;lt;br&amp;gt;DS-Replication-Get-Changes-All&amp;lt;br&amp;gt;DS-Replication-Get-Changes-In-Filtered-Set&amp;lt;br&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;These three domain permissions will allow a user to dump hashes from a domain controller&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;b&amp;gt;Tool examples:&amp;lt;br&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;mimikatz, secretsdump.py&amp;lt;/font&amp;gt;\&quot; style=\&quot;rounded=0;whiteSpace=wrap;html=1;fontSize=12;fillColor=#e3c800;strokeColor=#B09500;fontColor=#000000;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;495\&quot; y=\&quot;1106\&quot; width=\&quot;350\&quot; height=\&quot;200\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;40\&quot; style=\&quot;edgeStyle=none;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontSize=12;fontColor=#000000;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;37\&quot; target=\&quot;59\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;&lt;mxPoint x=\&quot;665\&quot; y=\&quot;1596\&quot; as=\&quot;targetPoint\&quot;/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;37\&quot; value=\&quot;&amp;lt;b&amp;gt;Enumerate Service Principal Names&amp;lt;br&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;SPNs are mapped in Domain &amp;lt;br&amp;gt;Controllers with the IP or hostname where the service account is &amp;lt;br&amp;gt;running. Can expose some attack surfaces early on without the need for &amp;lt;br&amp;gt;port scanning.&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;b&amp;gt;Often misconfigured with unneeded domain privileges or cleartext passwords in account descriptions.&amp;lt;/b&amp;gt;\&quot; style=\&quot;rounded=0;whiteSpace=wrap;html=1;fontSize=12;fillColor=#e3c800;strokeColor=#B09500;fontColor=#000000;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;495\&quot; y=\&quot;1356\&quot; width=\&quot;350\&quot; height=\&quot;200\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;48\&quot; value=\&quot;\&quot; style=\&quot;edgeStyle=none;html=1;fontSize=15;fontColor=#000000;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;42\&quot; target=\&quot;47\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;42\&quot; value=\&quot;&amp;lt;b&amp;gt;Enumerate Certificate Templates&amp;lt;br&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;If a certificate template has these three attributes set:&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;ul&amp;gt;&amp;lt;li style=&amp;quot;text-align: left;&amp;quot;&amp;gt;&amp;lt;b&amp;gt;msPKI-Certificate-Name-Flag: ENROLLEE_SUPPLIES_SUBJECT&amp;lt;/b&amp;gt;&amp;lt;/li&amp;gt;&amp;lt;li style=&amp;quot;text-align: left;&amp;quot;&amp;gt;&amp;lt;b&amp;gt;PkiExtendedKeyUsage: Client Authentication&amp;lt;/b&amp;gt;&amp;lt;/li&amp;gt;&amp;lt;li style=&amp;quot;text-align: left;&amp;quot;&amp;gt;&amp;lt;b&amp;gt;Enrollment Rights: NT Authority\\Auhenticated Users&amp;lt;/b&amp;gt;&amp;lt;/li&amp;gt;&amp;lt;/ul&amp;gt;&amp;lt;br&amp;gt;It could be used to impersonate &amp;lt;b&amp;gt;any user &amp;lt;/b&amp;gt;(even domain admins)&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;b&amp;gt;Tool Examples:&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;div style=&amp;quot;display: inline-block; line-height: 1.2; pointer-events: all; overflow-wrap: normal;&amp;quot;&amp;gt;certify.exe, rubeus&amp;lt;/div&amp;gt;\&quot; style=\&quot;rounded=0;whiteSpace=wrap;html=1;fontSize=12;fontColor=#000000;fillColor=#e3c800;strokeColor=#B09500;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;1025\&quot; y=\&quot;1446\&quot; width=\&quot;440\&quot; height=\&quot;240\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;52\&quot; value=\&quot;\&quot; style=\&quot;edgeStyle=none;html=1;fontSize=14;fontColor=#000000;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;47\&quot; target=\&quot;50\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;47\&quot; value=\&quot;&amp;lt;b&amp;gt;Using enumeration of users and groups:&amp;lt;br&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;Identify currently logged-on users on compromised host&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;Determine&amp;amp;nbsp;if high-value users are logged on. &amp;lt;br&amp;gt;&amp;lt;br&amp;gt;May be able to dump high-value&amp;amp;nbsp;passwords or hashes from memory and pass them around the network.\&quot; style=\&quot;shape=hexagon;perimeter=hexagonPerimeter2;whiteSpace=wrap;html=1;fixedSize=1;rounded=1;fontSize=15;fontColor=#000000;fillColor=#e3c800;strokeColor=#B09500;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;1025\&quot; y=\&quot;1726\&quot; width=\&quot;440\&quot; height=\&quot;220\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;55\&quot; style=\&quot;edgeStyle=none;html=1;fontSize=14;fontColor=#000000;exitX=1;exitY=1;exitDx=0;exitDy=0;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;50\&quot; target=\&quot;53\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;&lt;mxPoint x=\&quot;1247\&quot; y=\&quot;2226\&quot; as=\&quot;targetPoint\&quot;/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;70\&quot; style=\&quot;edgeStyle=none;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontSize=25;fontColor=#000000;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;50\&quot; target=\&quot;69\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;50\&quot; value=\&quot;&amp;lt;b&amp;gt;Lateral Movement / Pivoting&amp;lt;br&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;Hash / Ticket / Credential Discovery\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;fontSize=14;fontColor=#000000;fillColor=#fa6800;strokeColor=#C73500;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;1059.06\&quot; y=\&quot;1976\&quot; width=\&quot;371.88\&quot; height=\&quot;100\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;62\&quot; style=\&quot;edgeStyle=none;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=14;fontColor=#000000;exitX=1;exitY=0.444;exitDx=0;exitDy=0;exitPerimeter=0;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;53\&quot; target=\&quot;56\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;66\&quot; style=\&quot;edgeStyle=none;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=14;fontColor=#000000;exitX=1;exitY=0.5;exitDx=0;exitDy=0;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;53\&quot; target=\&quot;58\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;&lt;mxPoint x=\&quot;1527\&quot; y=\&quot;2186\&quot; as=\&quot;sourcePoint\&quot;/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;73\&quot; style=\&quot;edgeStyle=none;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=14;fontColor=#000000;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;53\&quot; target=\&quot;57\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;53\&quot; value=\&quot;&amp;lt;b&amp;gt;Pass the Password &amp;lt;br&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;Interactive Logon&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;-SMB&amp;lt;br&amp;gt;- RDP&amp;lt;br&amp;gt;- WinRM&amp;lt;br&amp;gt;- SSH&amp;lt;br&amp;gt;-&amp;amp;nbsp;Etc.\&quot; style=\&quot;whiteSpace=wrap;html=1;aspect=fixed;rounded=1;fontSize=14;fontColor=#000000;fillColor=#fa6800;strokeColor=#C73500;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;1347\&quot; y=\&quot;2106\&quot; width=\&quot;180\&quot; height=\&quot;180\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;77\&quot; style=\&quot;edgeStyle=none;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=14;fontColor=#000000;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;56\&quot; target=\&quot;75\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;56\&quot; value=\&quot;&amp;lt;b&amp;gt;Cleartext Password Discovery&amp;lt;br&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;b&amp;gt;WDigest&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;Tool Example:&amp;amp;nbsp;Mimikatz&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;b&amp;gt;Credential Mining&amp;lt;br&amp;gt;&amp;lt;/b&amp;gt;Tool example: PowerShell, CLI tools\&quot; style=\&quot;ellipse;whiteSpace=wrap;html=1;rounded=1;fontSize=14;fontColor=#000000;fillColor=#fa6800;strokeColor=#C73500;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;1611\&quot; y=\&quot;1790\&quot; width=\&quot;270\&quot; height=\&quot;230\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;76\&quot; style=\&quot;edgeStyle=none;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=14;fontColor=#000000;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;57\&quot; target=\&quot;75\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;57\&quot; value=\&quot;&amp;lt;div&amp;gt;&amp;lt;b&amp;gt;Low and Slow Password Spraying&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;See domain lockout policy&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;Plenty of PowerShell Scripts online to facilitate this with a wordlist&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;Tool example: crackmapexec, PowerShell&amp;lt;/div&amp;gt;\&quot; style=\&quot;ellipse;whiteSpace=wrap;html=1;rounded=1;fontSize=14;fontColor=#000000;fillColor=#fa6800;strokeColor=#C73500;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;1596\&quot; y=\&quot;2043\&quot; width=\&quot;300\&quot; height=\&quot;300\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;78\&quot; style=\&quot;edgeStyle=none;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=14;fontColor=#000000;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;58\&quot; target=\&quot;75\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;58\&quot; value=\&quot;&amp;lt;b&amp;gt;Dump hashes and crack locally&amp;lt;br&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;Tool examples&amp;amp;nbsp;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;secretsdump.py, crackmapexec\&quot; style=\&quot;ellipse;whiteSpace=wrap;html=1;rounded=1;fontSize=14;fontColor=#000000;fillColor=#fa6800;strokeColor=#C73500;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;1631\&quot; y=\&quot;2360\&quot; width=\&quot;230\&quot; height=\&quot;220\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;59\&quot; value=\&quot;&amp;lt;b&amp;gt;Kerberoasting&amp;lt;br&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;br style=&amp;quot;font-size: 12px;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;font-size: 12px;&amp;quot;&amp;gt;Request a TGS ticket and attempt to crack the SPN&#39;s hash in order to authenticate as the service principal and abuse any misconfigurations associated with the service principal.&amp;lt;/span&amp;gt;&amp;lt;br style=&amp;quot;font-size: 12px;&amp;quot;&amp;gt;&amp;lt;br style=&amp;quot;font-size: 12px;&amp;quot;&amp;gt;&amp;lt;b style=&amp;quot;font-size: 12px;&amp;quot;&amp;gt;Tool example:&amp;amp;nbsp;&amp;lt;/b&amp;gt;&amp;lt;span style=&amp;quot;font-size: 12px;&amp;quot;&amp;gt;GetUserSPNs.py&amp;lt;/span&amp;gt;\&quot; style=\&quot;ellipse;whiteSpace=wrap;html=1;rounded=1;fontSize=14;fontColor=#000000;fillColor=#fa6800;strokeColor=#C73500;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;485\&quot; y=\&quot;1596\&quot; width=\&quot;370\&quot; height=\&quot;170\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;72\&quot; style=\&quot;edgeStyle=none;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;fontSize=14;fontColor=#000000;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;69\&quot; target=\&quot;71\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;69\&quot; value=\&quot;&amp;lt;b&amp;gt;Hash | Ticket Passing&amp;lt;/b&amp;gt;\&quot; style=\&quot;whiteSpace=wrap;html=1;aspect=fixed;rounded=1;fontSize=14;fontColor=#000000;fillColor=#fa6800;strokeColor=#C73500;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;1155\&quot; y=\&quot;2200\&quot; width=\&quot;180\&quot; height=\&quot;180\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;88\&quot; style=\&quot;edgeStyle=none;html=1;exitX=0;exitY=1;exitDx=0;exitDy=0;entryX=0;entryY=0;entryDx=0;entryDy=0;fontSize=16;fontColor=#000000;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;71\&quot; target=\&quot;81\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;89\&quot; style=\&quot;edgeStyle=none;html=1;exitX=1;exitY=1;exitDx=0;exitDy=0;entryX=1;entryY=0;entryDx=0;entryDy=0;fontSize=16;fontColor=#000000;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;71\&quot; target=\&quot;83\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;71\&quot; value=\&quot;&amp;lt;font style=&amp;quot;font-size: 14px;&amp;quot;&amp;gt;Authentication Protocol?&amp;lt;br&amp;gt;&amp;lt;/font&amp;gt;\&quot; style=\&quot;ellipse;whiteSpace=wrap;html=1;rounded=0;shadow=0;glass=0;fontSize=25;fontColor=#000000;fillColor=#fa6800;strokeColor=#C73500;fontStyle=1\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;1035\&quot; y=\&quot;2604\&quot; width=\&quot;420\&quot; height=\&quot;170\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;75\&quot; value=\&quot;Whose password do we have?\&quot; style=\&quot;whiteSpace=wrap;html=1;aspect=fixed;rounded=0;shadow=0;glass=0;sketch=0;fontSize=14;fontColor=#ffffff;fillColor=#e51400;strokeColor=#B20000;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;1976\&quot; y=\&quot;2088\&quot; width=\&quot;210\&quot; height=\&quot;210\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;79\&quot; value=\&quot;\&quot; style=\&quot;shape=link;html=1;fontSize=14;fontColor=#000000;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry width=\&quot;100\&quot; relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;&lt;mxPoint x=\&quot;2086\&quot; y=\&quot;2690\&quot; as=\&quot;sourcePoint\&quot;/&gt;&lt;mxPoint x=\&quot;2086\&quot; y=\&quot;2298\&quot; as=\&quot;targetPoint\&quot;/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;80\&quot; value=\&quot;\&quot; style=\&quot;endArrow=classic;html=1;fontSize=14;fontColor=#000000;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; target=\&quot;71\&quot;&gt;&lt;mxGeometry width=\&quot;50\&quot; height=\&quot;50\&quot; relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;&lt;mxPoint x=\&quot;2090\&quot; y=\&quot;2689\&quot; as=\&quot;sourcePoint\&quot;/&gt;&lt;mxPoint x=\&quot;1640\&quot; y=\&quot;2651\&quot; as=\&quot;targetPoint\&quot;/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;84\&quot; value=\&quot;\&quot; style=\&quot;edgeStyle=none;html=1;fontSize=14;fontColor=#000000;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;81\&quot; target=\&quot;82\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;91\&quot; value=\&quot;\&quot; style=\&quot;edgeStyle=none;html=1;fontSize=16;fontColor=#000000;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;81\&quot; target=\&quot;90\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;93\&quot; style=\&quot;edgeStyle=none;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontSize=16;fontColor=#000000;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;81\&quot; target=\&quot;92\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;81\&quot; value=\&quot;&amp;lt;b&amp;gt;Kerberos&amp;lt;br&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;Use FQDM\&quot; style=\&quot;whiteSpace=wrap;html=1;aspect=fixed;rounded=0;shadow=0;glass=0;sketch=0;fontSize=14;fillColor=#f0a30a;strokeColor=#BD7000;fontColor=#000000;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;906\&quot; y=\&quot;2870\&quot; width=\&quot;149\&quot; height=\&quot;149\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;85\&quot; value=\&quot;\&quot; style=\&quot;edgeStyle=none;html=1;fontSize=14;fontColor=#000000;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;82\&quot; target=\&quot;83\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;82\&quot; value=\&quot;&amp;lt;div&amp;gt;&amp;lt;b&amp;gt;Is NTLM Enabled?&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;b&amp;gt;If you use an IP address while Kerberos is enabled, it will fallback to NTLM authentication.&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;\&quot; style=\&quot;whiteSpace=wrap;html=1;aspect=fixed;rounded=0;shadow=0;glass=0;sketch=0;fontSize=14;fillColor=#f0a30a;strokeColor=#BD7000;fontColor=#000000;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;1161\&quot; y=\&quot;2870\&quot; width=\&quot;149\&quot; height=\&quot;149\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;87\&quot; value=\&quot;\&quot; style=\&quot;edgeStyle=none;html=1;fontSize=16;fontColor=#000000;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;83\&quot; target=\&quot;86\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;94\&quot; style=\&quot;edgeStyle=none;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontSize=16;fontColor=#000000;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;83\&quot; target=\&quot;92\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;83\&quot; value=\&quot;&amp;lt;div&amp;gt;NTLM&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;Use IP addresses&amp;lt;/div&amp;gt;\&quot; style=\&quot;whiteSpace=wrap;html=1;aspect=fixed;rounded=0;shadow=0;glass=0;sketch=0;fontSize=14;fillColor=#f0a30a;strokeColor=#BD7000;fontColor=#000000;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;1425\&quot; y=\&quot;2870\&quot; width=\&quot;149\&quot; height=\&quot;149\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;86\&quot; value=\&quot;&amp;lt;span style=&amp;quot;font-size: 16px;&amp;quot;&amp;gt;&amp;lt;b&amp;gt;Dumping User Hashes&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;b&amp;gt;Who&#39;s logged on?&amp;lt;/b&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;b&amp;gt;&amp;lt;br style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;br style=&amp;quot;&amp;quot;&amp;gt;Domain admin? &amp;lt;br&amp;gt;&amp;lt;br&amp;gt;Other privileged user?&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;Can we pivot using unprivileged access?&amp;lt;br&amp;gt;&amp;lt;br style=&amp;quot;&amp;quot;&amp;gt;Can we dump anything from memory?&amp;lt;br style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;br&amp;gt;Tool example: Mimikatz&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;See also:&amp;amp;nbsp;&amp;lt;a href=&amp;quot;https://notes.benheater.com/books/active-directory/page/dumping-lsass-without-mimikatz&amp;quot;&amp;gt;Dumping LSASS without Mimikatz&amp;lt;/a&amp;gt;&amp;lt;br style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;br style=&amp;quot;&amp;quot;&amp;gt;NTLM hashes?&amp;lt;br style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;br style=&amp;quot;&amp;quot;&amp;gt;What&#39;s available on disk?&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;Tool example: PowerShell, reg save&amp;lt;br style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;br style=&amp;quot;&amp;quot;&amp;gt;NTLM hashes in SAM?&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;NTLM hashes from registry dump?&amp;lt;/b&amp;gt;\&quot; style=\&quot;whiteSpace=wrap;html=1;aspect=fixed;rounded=0;shadow=0;glass=0;sketch=0;fontSize=14;fillColor=#f0a30a;strokeColor=#BD7000;fontColor=#000000;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;1716\&quot; y=\&quot;2720\&quot; width=\&quot;460\&quot; height=\&quot;460\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;90\&quot; value=\&quot;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;b&amp;gt;Kerberos authenticates, does not authorize&amp;lt;br&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;It&amp;lt;br&amp;gt; is easy for an attacker to request and forge tickets with the Kerberos &amp;lt;br&amp;gt;authentication protocol, because Kerberos does not check if the user has&amp;lt;br&amp;gt; authorization&amp;amp;nbsp;to the resource; only if the credentials are correct.&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;Who&#39;s logged on?&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;Domain admin? Other privileged user?&amp;lt;br&amp;gt;Can we pivot using unprivileged access?&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;Can we dump anything from memory?&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;Dumping Tickets&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;Tool example: Mimikatz, Rubeus&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;Cached TGT? (Renewable?)&amp;lt;br&amp;gt;Cached TGS?&amp;lt;br&amp;gt;NTLM Hash? (Pass the ticket)&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;Dumping Hashes&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;Tool example: Mimikatz,&amp;amp;nbsp;PowerShell, reg save&amp;lt;br&amp;gt;See also:&amp;amp;nbsp;&amp;lt;a href=&amp;quot;https://notes.benheater.com/books/active-directory/page/dumping-lsass-without-mimikatz&amp;quot;&amp;gt;Dumping LSASS without Mimikatz&amp;lt;/a&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;NTLM hashes in SAM?&amp;lt;br&amp;gt;NTLM hashes from registry dump?&amp;lt;/font&amp;gt;\&quot; style=\&quot;whiteSpace=wrap;html=1;aspect=fixed;rounded=0;shadow=0;glass=0;sketch=0;fontSize=14;fillColor=#f0a30a;strokeColor=#BD7000;fontStyle=0;fontColor=#000000;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;315\&quot; y=\&quot;2685\&quot; width=\&quot;530\&quot; height=\&quot;530\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;102\&quot; style=\&quot;edgeStyle=none;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontSize=16;fontColor=#000000;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;92\&quot; target=\&quot;96\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;103\&quot; style=\&quot;edgeStyle=none;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontSize=16;fontColor=#000000;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;92\&quot; target=\&quot;97\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;104\&quot; style=\&quot;edgeStyle=none;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontSize=16;fontColor=#000000;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;92\&quot; target=\&quot;98\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;105\&quot; style=\&quot;edgeStyle=none;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontSize=16;fontColor=#000000;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;92\&quot; target=\&quot;99\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;106\&quot; style=\&quot;edgeStyle=none;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontSize=16;fontColor=#000000;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;92\&quot; target=\&quot;100\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;107\&quot; style=\&quot;edgeStyle=none;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontSize=16;fontColor=#000000;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;92\&quot; target=\&quot;101\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;92\&quot; value=\&quot;&amp;lt;div&amp;gt;Lateral Movement Tools &amp;amp;amp; Techniques&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;I&#39;ve made a best effort to summarize and list some common lateral movement tools and techniques here.&amp;amp;nbsp;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;Googling by their respective names will help you learn more about them and find similar or alternative techniques and tools.&amp;lt;/div&amp;gt;\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;shadow=0;glass=0;sketch=0;fontSize=16;fillColor=#e51400;strokeColor=#B20000;fontColor=#ffffff;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;995.5\&quot; y=\&quot;3240\&quot; width=\&quot;520\&quot; height=\&quot;160\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;111\&quot; style=\&quot;edgeStyle=none;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;fontSize=16;fontColor=#000000;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;96\&quot; target=\&quot;108\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;112\&quot; style=\&quot;edgeStyle=none;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;fontSize=16;fontColor=#000000;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;96\&quot; target=\&quot;110\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;116\&quot; style=\&quot;edgeStyle=none;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontSize=16;fontColor=#000000;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;96\&quot; target=\&quot;114\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;96\&quot; value=\&quot;&amp;lt;div&amp;gt;&amp;lt;b&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;Un/Constrained Delegation&amp;lt;/font&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;Allows a computer account access a service on behalf of another account.&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;b&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;Unconstrained&amp;lt;/font&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;The computer account can delegate access to any service for any account&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;b&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;Constrained&amp;lt;/font&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;The computer account can delegate access for specific users to specific services using a specified protocol.&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;shadow=0;glass=0;sketch=0;fontSize=16;fontColor=#ffffff;fillColor=#647687;strokeColor=#314354;fontStyle=0\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;642\&quot; y=\&quot;3530\&quot; width=\&quot;170\&quot; height=\&quot;590\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;117\&quot; style=\&quot;edgeStyle=none;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontSize=16;fontColor=#000000;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;97\&quot; target=\&quot;114\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;97\&quot; value=\&quot;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;b&amp;gt;Active Directory Certificate Services (ADCS)&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;If you&#39;ve managed to find a vulnerable certificate template, you can request a TGT as &amp;lt;b&amp;gt;any user&amp;lt;/b&amp;gt; (even domain admin) using a tool such as &amp;lt;b&amp;gt;rubeus&amp;lt;/b&amp;gt;.&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;Armed with the TGT, you could feasibly access administrative shares and resources on remote computers as a privileged user.&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/font&amp;gt;\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;shadow=0;glass=0;sketch=0;fontSize=16;fontColor=#ffffff;fillColor=#647687;strokeColor=#314354;fontStyle=0\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;862\&quot; y=\&quot;3530\&quot; width=\&quot;170\&quot; height=\&quot;590\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;118\&quot; style=\&quot;edgeStyle=none;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontSize=16;fontColor=#000000;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;98\&quot; target=\&quot;114\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;98\&quot; value=\&quot;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;b&amp;gt;AS-REP Roasting&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;Can use &amp;lt;b&amp;gt;GetNPUsers.py &amp;lt;/b&amp;gt;to enumerate accounts where AS-REP is disabled.&amp;amp;nbsp;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;Normally, a user must supply a pre-authentication hash of a timestamp which is validated by the DC.&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;When disabled, we can&amp;amp;nbsp; freely request a TGT for those accounts and attempt to crack the hash.&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/font&amp;gt;\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;shadow=0;glass=0;sketch=0;fontSize=16;fontColor=#ffffff;fillColor=#647687;strokeColor=#314354;fontStyle=0\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;1072\&quot; y=\&quot;3530\&quot; width=\&quot;170\&quot; height=\&quot;590\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;119\&quot; style=\&quot;edgeStyle=none;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;fontSize=16;fontColor=#000000;entryX=0.5;entryY=0;entryDx=0;entryDy=0;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;99\&quot; target=\&quot;114\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;&lt;mxPoint x=\&quot;1260\&quot; y=\&quot;4190\&quot; as=\&quot;targetPoint\&quot;/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;99\&quot; value=\&quot;&amp;lt;div&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;b&amp;gt;Overpass the Hash&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;Can create a TGT using a NTLM hash&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;With the TGT handy, can spawn a command prompt in the context of the user&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;Can now interact with remote hosts as this user (eg psexec)&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;Command execution requires admin&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/div&amp;gt;\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;shadow=0;glass=0;sketch=0;fontSize=16;fontColor=#ffffff;fillColor=#647687;strokeColor=#314354;fontStyle=0\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;1278\&quot; y=\&quot;3530\&quot; width=\&quot;170\&quot; height=\&quot;590\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;120\&quot; style=\&quot;edgeStyle=none;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontSize=16;fontColor=#000000;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;100\&quot; target=\&quot;114\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;100\&quot; value=\&quot;&amp;lt;div&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;b&amp;gt;Pass the Ticket&amp;lt;br&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;Have a password or NTLM hash for a computer account or a SPN?&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;Can use mimikatz&amp;amp;nbsp;or ticketer.py&amp;amp;nbsp;to create a silver ticket (TGS) and forge elevated permissions on the target.&amp;lt;/font&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;shadow=0;glass=0;sketch=0;fontSize=16;fontColor=#ffffff;fillColor=#647687;strokeColor=#314354;fontStyle=0\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;1485\&quot; y=\&quot;3530\&quot; width=\&quot;170\&quot; height=\&quot;590\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;121\&quot; style=\&quot;edgeStyle=none;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontSize=16;fontColor=#000000;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;101\&quot; target=\&quot;114\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;101\&quot; value=\&quot;&amp;lt;div&amp;gt;&amp;lt;span style=&amp;quot;background-color: initial;&amp;quot;&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;b&amp;gt;More Tools:&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;span style=&amp;quot;background-color: initial;&amp;quot;&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;span style=&amp;quot;background-color: initial;&amp;quot;&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;span style=&amp;quot;background-color: initial;&amp;quot;&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;span style=&amp;quot;background-color: initial;&amp;quot;&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;b&amp;gt;WMI Exec&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;b&amp;gt;WinRM&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;b&amp;gt;wmiexec.py&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;b&amp;gt;smbexec.py&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;b&amp;gt;psexec.py&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;b&amp;gt;CrackMapExec&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;b&amp;gt;PTH (Pass the Hash)&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;b&amp;gt;pth-winexe&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;shadow=0;glass=0;sketch=0;fontSize=16;fontColor=#ffffff;fillColor=#647687;strokeColor=#314354;fontStyle=0\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;1688\&quot; y=\&quot;3530\&quot; width=\&quot;170\&quot; height=\&quot;590\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;139\&quot; value=\&quot;\&quot; style=\&quot;edgeStyle=none;html=1;fontSize=16;fontColor=#FFFFFF;exitX=0.5;exitY=1;exitDx=0;exitDy=0;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;108\&quot; target=\&quot;138\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;108\&quot; value=\&quot;&amp;lt;div&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;b&amp;gt;Constrained Delegation&amp;lt;br&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;b&amp;gt;Abusing this scenario requires:&amp;lt;br&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;Admin control of the system assigned constrained delegation&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;Enumerate delegated access (msDS-allowedToDeleagteto) and figure out &amp;lt;b&amp;gt;who can access what&amp;lt;/b&amp;gt;.&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;Grab TGT from the delegated host.&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;Use TGT to request a TGS with S4U to request delegated access to the resource&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;Load the TGS into memory and access the service.&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/div&amp;gt;\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;shadow=0;glass=0;sketch=0;fontSize=16;fontColor=#ffffff;fillColor=#6d8764;strokeColor=#3A5431;fontStyle=0\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;210\&quot; y=\&quot;3400\&quot; width=\&quot;270\&quot; height=\&quot;430\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;115\&quot; style=\&quot;edgeStyle=none;html=1;exitX=1;exitY=0.75;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=16;fontColor=#000000;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;110\&quot; target=\&quot;114\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;110\&quot; value=\&quot;&amp;lt;div&amp;gt;&amp;lt;b style=&amp;quot;color: rgb(0, 0, 0);&amp;quot;&amp;gt;Unconstrained Delegation&amp;lt;br&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;br style=&amp;quot;color: rgb(0, 0, 0);&amp;quot;&amp;gt;&amp;lt;b style=&amp;quot;color: rgb(0, 0, 0);&amp;quot;&amp;gt;Abusing this scenario requires:&amp;lt;br&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;br style=&amp;quot;color: rgb(0, 0, 0);&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;color: rgb(0, 0, 0);&amp;quot;&amp;gt;Admin control of the system assigned unconstrained delegation&amp;lt;/span&amp;gt;&amp;lt;br style=&amp;quot;color: rgb(0, 0, 0);&amp;quot;&amp;gt;&amp;lt;br style=&amp;quot;color: rgb(0, 0, 0);&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;color: rgb(0, 0, 0);&amp;quot;&amp;gt;Set up bait and have a domain admin or DC connect to the bait (eg UNC share)&amp;lt;/span&amp;gt;&amp;lt;br style=&amp;quot;color: rgb(0, 0, 0);&amp;quot;&amp;gt;&amp;lt;br style=&amp;quot;color: rgb(0, 0, 0);&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;color: rgb(0, 0, 0);&amp;quot;&amp;gt;Dump the TGT from the system&amp;lt;/span&amp;gt;&amp;lt;br style=&amp;quot;color: rgb(0, 0, 0);&amp;quot;&amp;gt;&amp;lt;br style=&amp;quot;color: rgb(0, 0, 0);&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;color: rgb(0, 0, 0);&amp;quot;&amp;gt;Use the TGT to impersonate the admin, since this machine has unconstrained, delegated access to any service&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;shadow=0;glass=0;sketch=0;fontSize=16;fontColor=#ffffff;fillColor=#6d8764;strokeColor=#3A5431;fontStyle=0\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;215\&quot; y=\&quot;4030\&quot; width=\&quot;270\&quot; height=\&quot;370\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;125\&quot; style=\&quot;edgeStyle=none;html=1;exitX=0.25;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontSize=16;fontColor=#000000;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;114\&quot; target=\&quot;122\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;140\&quot; style=\&quot;edgeStyle=none;html=1;exitX=0.75;exitY=1;exitDx=0;exitDy=0;fontSize=16;fontColor=#FFFFFF;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;114\&quot; target=\&quot;123\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;114\&quot; value=\&quot;&amp;lt;span style=&amp;quot;font-size: 14px;&amp;quot;&amp;gt;Whose:&amp;lt;/span&amp;gt;&amp;lt;br style=&amp;quot;font-size: 14px;&amp;quot;&amp;gt;&amp;lt;br style=&amp;quot;font-size: 14px;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;font-size: 14px;&amp;quot;&amp;gt;Ticket |&amp;amp;nbsp;Hash |&amp;amp;nbsp;Credential | Privileges&amp;lt;/span&amp;gt;&amp;lt;br style=&amp;quot;font-size: 14px;&amp;quot;&amp;gt;&amp;lt;br style=&amp;quot;font-size: 14px;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;font-size: 14px;&amp;quot;&amp;gt;do we have?&amp;lt;/span&amp;gt;\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;shadow=0;glass=0;sketch=0;fontSize=16;fontColor=#ffffff;fillColor=#76608a;strokeColor=#432D57;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;1090.25\&quot; y=\&quot;4256\&quot; width=\&quot;309.5\&quot; height=\&quot;100\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;133\&quot; value=\&quot;\&quot; style=\&quot;edgeStyle=none;html=1;fontSize=16;fontColor=#FFFFFF;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;122\&quot; target=\&quot;126\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;122\&quot; value=\&quot;Unprivileged user&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;Semi-privileged user&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;Local admin (NTLM)\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;shadow=0;glass=0;sketch=0;fontSize=16;fontColor=#ffffff;fillColor=#FF6666;strokeColor=#314354;fontStyle=0\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;560\&quot; y=\&quot;4440\&quot; width=\&quot;170\&quot; height=\&quot;150\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;141\&quot; style=\&quot;edgeStyle=none;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=16;fontColor=#FFFFFF;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;123\&quot; target=\&quot;124\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;123\&quot; value=\&quot;&amp;lt;b&amp;gt;Member of Domain Admins&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;We own the domain and can access any domain-joined host\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;shadow=0;glass=0;sketch=0;fontSize=16;fontColor=#ffffff;fillColor=#e51400;strokeColor=#B20000;fontStyle=0\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;1224\&quot; y=\&quot;4414\&quot; width=\&quot;195\&quot; height=\&quot;160\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;144\&quot; style=\&quot;edgeStyle=none;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;fontSize=20;fontColor=#FFFFFF;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;124\&quot; target=\&quot;143\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;124\&quot; value=\&quot;&amp;lt;b&amp;gt;RDP&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;If you&#39;ve cracked the hash, could login to the domain controller as the domain admin, or try &amp;lt;b&amp;gt;xfreerdp &amp;lt;/b&amp;gt;with the &amp;lt;b&amp;gt;/pth&amp;lt;/b&amp;gt;&amp;amp;nbsp;option.&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;b&amp;gt;Hash / Ticket&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;Can &amp;lt;b&amp;gt;pass the hash / ticket&amp;lt;/b&amp;gt;&amp;amp;nbsp;to the domain controller, or try command execution using SMB, WinRM, WMI, PsExec, etc to gain access to the domain controller\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;shadow=0;glass=0;sketch=0;fontSize=16;fontColor=#ffffff;fillColor=#e51400;strokeColor=#B20000;fontStyle=0\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;1466\&quot; y=\&quot;4400\&quot; width=\&quot;570.5\&quot; height=\&quot;190\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;134\&quot; value=\&quot;\&quot; style=\&quot;edgeStyle=none;html=1;fontSize=16;fontColor=#FFFFFF;entryX=0.5;entryY=0;entryDx=0;entryDy=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;126\&quot; target=\&quot;130\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;135\&quot; style=\&quot;edgeStyle=none;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;fontSize=16;fontColor=#FFFFFF;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;126\&quot; target=\&quot;131\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;137\&quot; style=\&quot;edgeStyle=none;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontSize=16;fontColor=#FFFFFF;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;126\&quot; target=\&quot;136\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;126\&quot; value=\&quot;What&#39;s the next hop?\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;shadow=0;glass=0;sketch=0;fontSize=16;fontColor=#ffffff;fillColor=#FF6666;strokeColor=#314354;fontStyle=0\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;560\&quot; y=\&quot;4630\&quot; width=\&quot;170\&quot; height=\&quot;150\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;130\&quot; value=\&quot;&amp;lt;b&amp;gt;Unprivileged Domain User&amp;lt;br&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;-&amp;amp;nbsp;Interactive Login&amp;lt;br&amp;gt;&amp;amp;nbsp;Can we use a credential to RDP / SSH into another domain-joined host, escalate privilege and enumerate some more?&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;- User Hash / Ticket&amp;lt;br&amp;gt;You can try passing atacks&amp;amp;nbsp;with&amp;lt;br&amp;gt;Impacket / CrackMapExec and see if anything sticks.&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;Usually requires&amp;amp;nbsp;admin account to successfully get a shell with pass the hash attacks.&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;Unprivileged user may have some localized administration privileges on specific hosts.&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;Can you crack the hash?&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;Use interactive logon or CrackMapExec to see where you can logon with the credential.&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;\&quot; style=\&quot;rounded=0;whiteSpace=wrap;html=1;shadow=0;glass=0;sketch=0;fontSize=16;fontColor=#FFFFFF;fillColor=#ff6666;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;300\&quot; y=\&quot;4880\&quot; width=\&quot;210\&quot; height=\&quot;700\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;131\&quot; value=\&quot;&amp;lt;b&amp;gt;Semi-privileged Domain User&amp;lt;br&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;- Privilege Level&amp;lt;br&amp;gt;The&amp;lt;br&amp;gt;user may not be an outright domain admin, but may have certain group&amp;lt;br&amp;gt;memberships or domain privileges that allow us to further pivot to other&amp;lt;br&amp;gt;interesting resources.&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;-&amp;amp;nbsp;Interactive Login&amp;lt;br&amp;gt;&amp;amp;nbsp;Can we use a credential to RDP / SSH into another domain-joined host, escalate privilege and enumerate some more?&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;- User Hash / Ticket&amp;lt;br&amp;gt;Given the user&#39;s restricted privileges, it may be worth trying to pass the hash / ticket around the domain with CrackMapExec and see what sticks&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;Can you crack the hash? Use interactive logon or CrackMapExec to see where you can logon with the credential.\&quot; style=\&quot;rounded=0;whiteSpace=wrap;html=1;shadow=0;glass=0;sketch=0;fontSize=16;fontColor=#FFFFFF;fillColor=#ff6666;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;540\&quot; y=\&quot;4880\&quot; width=\&quot;210\&quot; height=\&quot;700\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;132\&quot; value=\&quot;PIVOT AND ENUMERATE MORE\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;shadow=0;glass=0;sketch=0;fontSize=16;fontColor=#FFFFFF;fillColor=#ff6666;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;315\&quot; y=\&quot;5610\&quot; width=\&quot;660\&quot; height=\&quot;110\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;136\&quot; value=\&quot;Local (non-domain) System Admin&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;-&amp;amp;nbsp;Repeated Credential&amp;lt;br&amp;gt;&amp;amp;nbsp;Can&amp;lt;br&amp;gt; we use a credential to RDP / SSH into another host, as the local admin?&amp;lt;br&amp;gt; Many organizations use the same credentials when imaging computers to &amp;lt;br&amp;gt;save time and automate deployment. &amp;lt;br&amp;gt;&amp;lt;br&amp;gt;Being local admin will make it far easier to enumerate and dump information on any additional hosts.&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;- User Hash&amp;lt;br&amp;gt;You can try passing the hash with CrackMapExec (don&#39;t specify a domain) and see if anything sticks.&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;Can you crack the hash? Use interactive logon or CrackMapExec to see where you can logon with the credential.&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;\&quot; style=\&quot;rounded=0;whiteSpace=wrap;html=1;shadow=0;glass=0;sketch=0;fontSize=16;fontColor=#FFFFFF;fillColor=#ff6666;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;785.5\&quot; y=\&quot;4880\&quot; width=\&quot;210\&quot; height=\&quot;700\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;138\&quot; value=\&quot;&amp;lt;div&amp;gt;&amp;lt;font color=&amp;quot;#000000&amp;quot;&amp;gt;&amp;lt;b&amp;gt;Determine escalation path from next hop&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;shadow=0;glass=0;sketch=0;fontSize=16;fontColor=#ffffff;fillColor=#6d8764;strokeColor=#3A5431;fontStyle=0;direction=south;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;300\&quot; y=\&quot;3890\&quot; width=\&quot;90\&quot; height=\&quot;100\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;155\&quot; style=\&quot;edgeStyle=none;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=16;fontColor=#FFFFFF;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;143\&quot; target=\&quot;145\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;156\&quot; style=\&quot;edgeStyle=none;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=16;fontColor=#FFFFFF;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;143\&quot; target=\&quot;150\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;157\&quot; style=\&quot;edgeStyle=none;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=16;fontColor=#FFFFFF;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;143\&quot; target=\&quot;152\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;158\&quot; style=\&quot;edgeStyle=none;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=-0.001;entryY=0.6;entryDx=0;entryDy=0;entryPerimeter=0;fontSize=16;fontColor=#FFFFFF;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;143\&quot; target=\&quot;153\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;143\&quot; value=\&quot;&amp;lt;font style=&amp;quot;font-size: 20px;&amp;quot;&amp;gt;Active Directory Persistence&amp;lt;/font&amp;gt;\&quot; style=\&quot;ellipse;whiteSpace=wrap;html=1;rounded=0;shadow=0;glass=0;sketch=0;fontSize=16;fontColor=#ffffff;fillColor=#e51400;strokeColor=#B20000;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;1617.75\&quot; y=\&quot;4670\&quot; width=\&quot;269\&quot; height=\&quot;200\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;145\&quot; value=\&quot;&amp;lt;div style=&amp;quot;display: inline-block; line-height: 1.2; pointer-events: all; overflow-wrap: normal;&amp;quot;&amp;gt;&amp;lt;font style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;font-size: 14px;&amp;quot;&amp;gt;&amp;lt;b&amp;gt;Multiple Persistence Methods&amp;lt;/b&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;span style=&amp;quot;font-size: 14px;&amp;quot;&amp;gt;&amp;lt;b&amp;gt;https://adsecurity.org/?p=1714&amp;lt;br&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;\&quot; style=\&quot;rounded=0;whiteSpace=wrap;html=1;shadow=0;glass=0;sketch=0;fontSize=16;fontColor=#ffffff;fillColor=#e51400;strokeColor=#B20000;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;2023\&quot; y=\&quot;4620\&quot; width=\&quot;184\&quot; height=\&quot;170\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;148\&quot; value=\&quot;\&quot; style=\&quot;edgeStyle=none;html=1;fontSize=14;fontColor=#FFFFFF;\&quot; edge=\&quot;1\&quot; parent=\&quot;1\&quot; source=\&quot;146\&quot; target=\&quot;147\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;146\&quot; value=\&quot;&amp;lt;span class=&amp;quot;comments-comment-item__main-content feed-shared-main-content--comment t-14 t-black t-normal&amp;quot;&amp;gt;&amp;lt;span dir=&amp;quot;ltr&amp;quot;&amp;gt;show me some love?&amp;lt;br&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;/span&amp;gt;\&quot; style=\&quot;rhombus;whiteSpace=wrap;html=1;rounded=0;shadow=0;glass=0;sketch=0;fontSize=14;fontColor=#000000;fillColor=#e3c800;strokeColor=#B09500;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;60\&quot; y=\&quot;30\&quot; width=\&quot;230\&quot; height=\&quot;230\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;147\&quot; value=\&quot;YES?&amp;lt;br style=&amp;quot;color: rgb(0, 0, 0);&amp;quot;&amp;gt;&amp;lt;br style=&amp;quot;color: rgb(0, 0, 0);&amp;quot;&amp;gt;&amp;lt;a data-test-app-aware-link=&amp;quot;&amp;quot; href=&amp;quot;http://patreon.com/user?u=87430788&amp;quot; target=&amp;quot;_self&amp;quot; class=&amp;quot;app-aware-link&amp;quot;&amp;gt;patreon.com/user?u=87430788&amp;lt;/a&amp;gt;\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;shadow=0;glass=0;sketch=0;fontSize=14;fillColor=#232B20;strokeColor=#3A5431;fontColor=#ffffff;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;320\&quot; y=\&quot;113.75\&quot; width=\&quot;220\&quot; height=\&quot;62.5\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;150\&quot; value=\&quot;&amp;lt;div style=&amp;quot;display: inline-block; line-height: 1.2; pointer-events: all; overflow-wrap: normal;&amp;quot;&amp;gt;&amp;lt;font style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;b&amp;gt;Golden Ticket&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;Once the domain controller has been owned, we can access the &amp;lt;b&amp;gt;krbtgt &amp;lt;/b&amp;gt;hash and create crafted TGTs&amp;lt;br&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;\&quot; style=\&quot;rounded=0;whiteSpace=wrap;html=1;shadow=0;glass=0;sketch=0;fontSize=16;fontColor=#ffffff;fillColor=#e51400;strokeColor=#B20000;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;2023\&quot; y=\&quot;4820\&quot; width=\&quot;184\&quot; height=\&quot;170\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;151\&quot; value=\&quot;&amp;lt;div style=&amp;quot;display: inline-block; line-height: 1.2; pointer-events: all; overflow-wrap: normal;&amp;quot;&amp;gt;&amp;lt;font style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;b&amp;gt;Dump User Hashes&amp;lt;br&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;NTDS.dit file&amp;lt;br&amp;gt;Mimikatz dump&amp;lt;br&amp;gt;Mimikatz DC Sync&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;\&quot; style=\&quot;rounded=0;whiteSpace=wrap;html=1;shadow=0;glass=0;sketch=0;fontSize=16;fontColor=#ffffff;fillColor=#e51400;strokeColor=#B20000;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;2030\&quot; y=\&quot;5020\&quot; width=\&quot;184\&quot; height=\&quot;170\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;152\&quot; value=\&quot;&amp;lt;div style=&amp;quot;display: inline-block; line-height: 1.2; pointer-events: all; overflow-wrap: normal;&amp;quot;&amp;gt;&amp;lt;div style=&amp;quot;display: inline-block; line-height: 1.2; pointer-events: all; overflow-wrap: normal;&amp;quot;&amp;gt;&amp;lt;b&amp;gt;AdminSDHolder&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;b&amp;gt;https://pentestlab.blog/2022/01/04/domain-persistence-adminsdholder/&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;\&quot; style=\&quot;rounded=0;whiteSpace=wrap;html=1;shadow=0;glass=0;sketch=0;fontSize=16;fontColor=#ffffff;fillColor=#e51400;strokeColor=#B20000;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;1957\&quot; y=\&quot;5220\&quot; width=\&quot;330\&quot; height=\&quot;250\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;153\&quot; value=\&quot;&amp;lt;div style=&amp;quot;display: inline-block; line-height: 1.2; pointer-events: all; overflow-wrap: normal;&amp;quot;&amp;gt;&amp;lt;font style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;div style=&amp;quot;display: inline-block; line-height: 1.2; pointer-events: all; font-weight: bold; overflow-wrap: normal;&amp;quot;&amp;gt;&amp;lt;font style=&amp;quot;font-size: 16px;&amp;quot;&amp;gt;Computer Accounts&amp;lt;br&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;https://www.hackingarticles.in/domain-persistence-computer-accounts/&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;\&quot; style=\&quot;rounded=0;whiteSpace=wrap;html=1;shadow=0;glass=0;sketch=0;fontSize=16;fontColor=#ffffff;fillColor=#e51400;strokeColor=#B20000;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;1930\&quot; y=\&quot;5500\&quot; width=\&quot;370\&quot; height=\&quot;180\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;159\&quot; value=\&quot;DONE SON !\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;shadow=0;glass=0;sketch=0;fontSize=16;fontColor=#ffffff;fillColor=#e51400;strokeColor=#B20000;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;1869.75\&quot; y=\&quot;5720\&quot; width=\&quot;504.5\&quot; height=\&quot;100\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;162\&quot; value=\&quot;Inspired by:&amp;amp;nbsp;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;https://benheater.com/active-directory-attack-map/\&quot; style=\&quot;shape=process;whiteSpace=wrap;html=1;backgroundOutline=1;rounded=0;shadow=0;glass=0;sketch=0;fontSize=16;fontColor=#FFFFFF;fillColor=#232B20;\&quot; vertex=\&quot;1\&quot; parent=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;30\&quot; y=\&quot;320\&quot; width=\&quot;430.25\&quot; height=\&quot;117\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;/root&gt;&lt;/mxGraphModel&gt;&lt;/diagram&gt;&lt;/mxfile&gt;&quot;}"></div>
<script type="text/javascript" src="https://viewer.diagrams.net/js/viewer-static.min.js"></script>